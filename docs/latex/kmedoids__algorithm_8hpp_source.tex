\hypertarget{kmedoids__algorithm_8hpp_source}{}\doxysection{kmedoids\+\_\+algorithm.\+hpp}
\label{kmedoids__algorithm_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/algorithms/kmedoids\_algorithm.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/algorithms/kmedoids\_algorithm.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef HEADERS\_ALGORITHMS\_KMEDOIDS\_ALGORITHM\_HPP\_}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define HEADERS\_ALGORITHMS\_KMEDOIDS\_ALGORITHM\_HPP\_}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <armadillo>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <tuple>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{13 }
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{namespace }km \{}
\DoxyCodeLine{29 \textcolor{keyword}{class }\mbox{\hyperlink{classkm_1_1KMedoids}{KMedoids}} \{}
\DoxyCodeLine{30  \textcolor{keyword}{public}:}
\DoxyCodeLine{31   \mbox{\hyperlink{classkm_1_1KMedoids_a0a09762011e8dfa7b520765c37f5f3e7}{KMedoids}}(}
\DoxyCodeLine{32     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a7d8a592e525c919e2b124085b99b5400}{n\_medoids}} = 5,}
\DoxyCodeLine{33     \textcolor{keyword}{const} std::string\& \mbox{\hyperlink{classkm_1_1KMedoids_ae444145a3bc114dd28a6c094fcfdf827}{algorithm}} = \textcolor{stringliteral}{"{}BanditPAM"{}},}
\DoxyCodeLine{34     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_af7c457dbb6c4c836b72624c9720aa8cb}{max\_iter}} = 1000,}
\DoxyCodeLine{35     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a068895dab1b234dae0b04c21e935a2cf}{buildConfidence}} = 1000,}
\DoxyCodeLine{36     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a8f29b104f30ae18296d6024d53d899df}{swapConfidence}} = 10000);}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   \mbox{\hyperlink{classkm_1_1KMedoids_a95542daf31e84a3e739731a7786b3655}{\string~KMedoids}}();}
\DoxyCodeLine{39 }
\DoxyCodeLine{40   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_ac426d41296cc375d705f959c85954428}{fit}}(\textcolor{keyword}{const} arma::mat\& inputData, \textcolor{keyword}{const} std::string\& loss);}
\DoxyCodeLine{41 }
\DoxyCodeLine{42   \textcolor{comment}{// The functions below are getters for read-\/only attributes}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_ac6e6bcd2aa27881912abeac752b9b90f}{getMedoidsFinal}}() \textcolor{keyword}{const};}
\DoxyCodeLine{45 }
\DoxyCodeLine{46   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_aafbdccf269bd382f93a3e125d00aa44f}{getMedoidsBuild}}() \textcolor{keyword}{const};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_ad7a4901d0b860ae002e6029d37553e4a}{getLabels}}() \textcolor{keyword}{const};}
\DoxyCodeLine{49 }
\DoxyCodeLine{50   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_af5852965702f0d32c0138cc8a1c817bd}{getSteps}}() \textcolor{keyword}{const};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{comment}{// The functions below are get/set functions for attributes}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a6a97acb3337a434ecce7f02f5c9a561d}{getNMedoids}}() \textcolor{keyword}{const};}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_a0c43b66114a5c7ea104027f408cef110}{setNMedoids}}(\textcolor{keywordtype}{size\_t} new\_num);}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   std::string \mbox{\hyperlink{classkm_1_1KMedoids_a7c8e32b37bf3e2be78c6545a4cf8eb8f}{getAlgorithm}}() \textcolor{keyword}{const};}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_aba765d2e27af9d85b7eaf05699cee4a4}{setAlgorithm}}(\textcolor{keyword}{const} std::string\& new\_alg);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_abd868fa5077d0526645788d732dbfe05}{getMaxIter}}() \textcolor{keyword}{const};}
\DoxyCodeLine{63 }
\DoxyCodeLine{64   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_a3a742098e57ded57fd606e08e0d315f0}{setMaxIter}}(\textcolor{keywordtype}{size\_t} new\_max);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a0ddcceed88446ec0dc25b9986a3eeaee}{getbuildConfidence}}() \textcolor{keyword}{const};}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_aca6efb798341eda10f94f7e7357d81f9}{setbuildConfidence}}(\textcolor{keywordtype}{size\_t} new\_buildConfidence);}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a0e69358b8872084f1f8d6a9ae67d6fb6}{getswapConfidence}}() \textcolor{keyword}{const};}
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_acfd4e8a8696c6db5ec1d7c7682955e76}{setswapConfidence}}(\textcolor{keywordtype}{size\_t} new\_swapConfidence);}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_ab0c41b1a22079045c0d3ea4a9bb408af}{setLossFn}}(std::string loss);}
\DoxyCodeLine{75 }
\DoxyCodeLine{77   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_afef3fcd749d67ee223fd173d03a46af5}{cache\_multiplier}} = 1000;}
\DoxyCodeLine{78 }
\DoxyCodeLine{80   \textcolor{keywordtype}{float}* \mbox{\hyperlink{classkm_1_1KMedoids_aaf5999794e1e6a9cf7587b45af7965d4}{cache}};}
\DoxyCodeLine{81 }
\DoxyCodeLine{83   arma::uvec \mbox{\hyperlink{classkm_1_1KMedoids_a46b93a3254181304f495ae4afd38c926}{permutation}};}
\DoxyCodeLine{84 }
\DoxyCodeLine{86   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_ab61cd26a588c5eabf8e3422c1018aa8d}{permutation\_idx}};}
\DoxyCodeLine{87 }
\DoxyCodeLine{89   std::unordered\_map<size\_t, size\_t> \mbox{\hyperlink{classkm_1_1KMedoids_aab55aa7e43d9680645eb4c6c429440a6}{reindex}};}
\DoxyCodeLine{90 }
\DoxyCodeLine{92   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classkm_1_1KMedoids_ae2041c73d811dfe6f152b36e81c6e632}{use\_perm}} = \textcolor{keyword}{true};}
\DoxyCodeLine{93 }
\DoxyCodeLine{95   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classkm_1_1KMedoids_adacf668171943d8431a1fb8f42b2e383}{use\_cache\_p}} = \textcolor{keyword}{true};}
\DoxyCodeLine{96 }
\DoxyCodeLine{97  \textcolor{keyword}{protected}:}
\DoxyCodeLine{98   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_a7a16c2704034e3afc28f1cf186db7a04}{calc\_best\_distances\_swap}}(}
\DoxyCodeLine{99     \textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{100     \textcolor{keyword}{const} arma::urowvec* medoidIndices,}
\DoxyCodeLine{101     arma::rowvec* best\_distances,}
\DoxyCodeLine{102     arma::rowvec* second\_distances,}
\DoxyCodeLine{103     arma::urowvec* assignments);}
\DoxyCodeLine{104 }
\DoxyCodeLine{105   \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_aa7cb9c429e262c98a8fc4f72d733f439}{calc\_loss}}(}
\DoxyCodeLine{106     \textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{107     \textcolor{keyword}{const} arma::urowvec* medoidIndices);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109   \textcolor{comment}{// NOTE: if you change use\_cache, also change use\_cache\_p}}
\DoxyCodeLine{110   \textcolor{keywordtype}{double} cachedLoss(}
\DoxyCodeLine{111     \textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{112     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{113     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j,}
\DoxyCodeLine{114     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} use\_cache = \textcolor{keyword}{true});}
\DoxyCodeLine{115 }
\DoxyCodeLine{116   \textcolor{comment}{// Loss functions}}
\DoxyCodeLine{118 \textcolor{comment}{}  \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_aac643b12f690a1c17d75cb13237995fa}{lp}};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120   \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_a2aa3152d40f9d336f914ccf7f72e2cb2}{LP}}(}
\DoxyCodeLine{121     \textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{122     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{123     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j) \textcolor{keyword}{const};}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_a45a4e929219f75b636d6255236bfc5d5}{LINF}}(\textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{126     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{127     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j) \textcolor{keyword}{const};}
\DoxyCodeLine{128 }
\DoxyCodeLine{129   \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_abdc5d139741261b5ba83362ba40f32ec}{cos}}(\textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{130     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{131     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j) \textcolor{keyword}{const};}
\DoxyCodeLine{132 }
\DoxyCodeLine{133   \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_a22a101f7d20ffb6bc1f1defbb9144842}{manhattan}}(\textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{134     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{135     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j) \textcolor{keyword}{const};}
\DoxyCodeLine{136 }
\DoxyCodeLine{137   \textcolor{keywordtype}{void} \mbox{\hyperlink{classkm_1_1KMedoids_a17b80a7aa3777dcba6abc471a813a1d6}{checkAlgorithm}}(\textcolor{keyword}{const} std::string\& \mbox{\hyperlink{classkm_1_1KMedoids_ae444145a3bc114dd28a6c094fcfdf827}{algorithm}}) \textcolor{keyword}{const};}
\DoxyCodeLine{138 }
\DoxyCodeLine{140   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a7d8a592e525c919e2b124085b99b5400}{n\_medoids}};}
\DoxyCodeLine{141 }
\DoxyCodeLine{143   std::string \mbox{\hyperlink{classkm_1_1KMedoids_ae444145a3bc114dd28a6c094fcfdf827}{algorithm}};}
\DoxyCodeLine{144 }
\DoxyCodeLine{146   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_af7c457dbb6c4c836b72624c9720aa8cb}{max\_iter}};}
\DoxyCodeLine{147 }
\DoxyCodeLine{149   arma::mat \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}};}
\DoxyCodeLine{150 }
\DoxyCodeLine{152   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_a1179ba0198699e438436ad3724d78ab3}{labels}};}
\DoxyCodeLine{153 }
\DoxyCodeLine{155   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_abc406948ac96646449a8a49ee2dac60c}{medoid\_indices\_build}};}
\DoxyCodeLine{156 }
\DoxyCodeLine{158   arma::urowvec \mbox{\hyperlink{classkm_1_1KMedoids_ae2f54264348a90f2c4c11aae05fca06e}{medoid\_indices\_final}};}
\DoxyCodeLine{159 }
\DoxyCodeLine{161   double (\mbox{\hyperlink{classkm_1_1KMedoids}{KMedoids}}::*\mbox{\hyperlink{classkm_1_1KMedoids_a32d93b299d6172a95f2c390dd11599c0}{lossFn}})(}
\DoxyCodeLine{162     \textcolor{keyword}{const} arma::mat\& \mbox{\hyperlink{classkm_1_1KMedoids_a802d0a1a8ca4d09300b856097128d6b1}{data}},}
\DoxyCodeLine{163     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} i,}
\DoxyCodeLine{164     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} j)}
\DoxyCodeLine{165     \textcolor{keyword}{const};}
\DoxyCodeLine{166 }
\DoxyCodeLine{168   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a88969d67d5473d1e9dc4fc333234f9d2}{steps}};}
\DoxyCodeLine{169 }
\DoxyCodeLine{171   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a068895dab1b234dae0b04c21e935a2cf}{buildConfidence}};}
\DoxyCodeLine{172 }
\DoxyCodeLine{174   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a8f29b104f30ae18296d6024d53d899df}{swapConfidence}};}
\DoxyCodeLine{175 }
\DoxyCodeLine{177   \textcolor{keyword}{const} \textcolor{keywordtype}{double} \mbox{\hyperlink{classkm_1_1KMedoids_a17d0a3d805cc5d3084ff5cf996b530cc}{precision}} = 0.001;}
\DoxyCodeLine{178 }
\DoxyCodeLine{180   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classkm_1_1KMedoids_a016fb11aaa66ac25b1d072f370a5fab7}{batchSize}} = 100;}
\DoxyCodeLine{181 \};}
\DoxyCodeLine{182 \}  \textcolor{comment}{// namespace km}}
\DoxyCodeLine{183 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// HEADERS\_ALGORITHMS\_KMEDOIDS\_ALGORITHM\_HPP\_}}

\end{DoxyCode}
