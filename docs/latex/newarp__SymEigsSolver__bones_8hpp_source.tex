\hypertarget{newarp__SymEigsSolver__bones_8hpp_source}{}\doxysection{newarp\+\_\+\+Sym\+Eigs\+Solver\+\_\+bones.\+hpp}
\label{newarp__SymEigsSolver__bones_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_SymEigsSolver\_bones.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_SymEigsSolver\_bones.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }newarp}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{22 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keywordtype}{int} SelectionRule, \textcolor{keyword}{typename} OpType>}
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{classnewarp_1_1SymEigsSolver}{SymEigsSolver}}}
\DoxyCodeLine{24   \{}
\DoxyCodeLine{25   \textcolor{keyword}{protected}:}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   \textcolor{keyword}{const} OpType\&     op;        \textcolor{comment}{// object to conduct matrix operation, e.g. matrix-\/vector product}}
\DoxyCodeLine{28   \textcolor{keyword}{const} uword       nev;       \textcolor{comment}{// number of eigenvalues requested}}
\DoxyCodeLine{29   \mbox{\hyperlink{classCol}{Col<eT>}}           ritz\_val;  \textcolor{comment}{// ritz values}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{comment}{// Sort the first nev Ritz pairs in ascending algebraic order}}
\DoxyCodeLine{32   \textcolor{comment}{// This is used to return the final results}}
\DoxyCodeLine{33   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} sort\_ritzpair();}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{keyword}{private}:}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   \textcolor{keyword}{const} uword       dim\_n;     \textcolor{comment}{// dimension of matrix A}}
\DoxyCodeLine{39   \textcolor{keyword}{const} uword       ncv;       \textcolor{comment}{// number of ritz values}}
\DoxyCodeLine{40   uword             nmatop;    \textcolor{comment}{// number of matrix operations called}}
\DoxyCodeLine{41   uword             niter;     \textcolor{comment}{// number of restarting iterations}}
\DoxyCodeLine{42   \mbox{\hyperlink{classMat}{Mat<eT>}}           fac\_V;     \textcolor{comment}{// V matrix in the Arnoldi factorisation}}
\DoxyCodeLine{43   \mbox{\hyperlink{classMat}{Mat<eT>}}           fac\_H;     \textcolor{comment}{// H matrix in the Arnoldi factorisation}}
\DoxyCodeLine{44   \mbox{\hyperlink{classCol}{Col<eT>}}           fac\_f;     \textcolor{comment}{// residual in the Arnoldi factorisation}}
\DoxyCodeLine{45   \mbox{\hyperlink{classMat}{Mat<eT>}}           ritz\_vec;  \textcolor{comment}{// ritz vectors}}
\DoxyCodeLine{46   \mbox{\hyperlink{classCol}{Col<eT>}}           ritz\_est;  \textcolor{comment}{// last row of ritz\_vec}}
\DoxyCodeLine{47   std::vector<bool> ritz\_conv; \textcolor{comment}{// indicator of the convergence of ritz values}}
\DoxyCodeLine{48   \textcolor{keyword}{const} eT          eps;       \textcolor{comment}{// the machine precision}}
\DoxyCodeLine{49                                \textcolor{comment}{// e.g. \string~= 1e-\/16 for double type}}
\DoxyCodeLine{50   \textcolor{keyword}{const} eT          eps23;     \textcolor{comment}{// eps\string^(2/3), used in convergence test}}
\DoxyCodeLine{51                                \textcolor{comment}{// tol*eps23 is the absolute tolerance}}
\DoxyCodeLine{52   \textcolor{keyword}{const} eT          near0;     \textcolor{comment}{// a very small value, but 1/near0 does not overflow}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{comment}{// Arnoldi factorisation starting from step-\/k}}
\DoxyCodeLine{55   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} factorise\_from(uword from\_k, uword to\_m, \textcolor{keyword}{const} \mbox{\hyperlink{classCol}{Col<eT>}}\& fk);}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \textcolor{comment}{// Implicitly restarted Arnoldi factorisation}}
\DoxyCodeLine{58   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} restart(uword k);}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{comment}{// Calculate the number of converged Ritz values}}
\DoxyCodeLine{61   \textcolor{keyword}{inline} uword num\_converged(eT tol);}
\DoxyCodeLine{62 }
\DoxyCodeLine{63   \textcolor{comment}{// Return the adjusted nev for restarting}}
\DoxyCodeLine{64   \textcolor{keyword}{inline} uword nev\_adjusted(uword nconv);}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   \textcolor{comment}{// Retrieve and sort ritz values and ritz vectors}}
\DoxyCodeLine{67   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} retrieve\_ritzpair();}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{keyword}{public}:}
\DoxyCodeLine{71 }
\DoxyCodeLine{73   \textcolor{keyword}{inline} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a578693d73354e102b2bc8347e078a8db}{SymEigsSolver}}(\textcolor{keyword}{const} OpType\& \mbox{\hyperlink{structop__}{op\_}}, uword nev\_, uword ncv\_);}
\DoxyCodeLine{74 }
\DoxyCodeLine{76   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a59b4ba524962eb040fc283742484e66e}{init}}(eT* init\_resid);}
\DoxyCodeLine{77 }
\DoxyCodeLine{79   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a59b4ba524962eb040fc283742484e66e}{init}}();}
\DoxyCodeLine{80 }
\DoxyCodeLine{82   \textcolor{keyword}{inline} uword \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_ab4816cb795d9643cf92a8288b8fea6bb}{compute}}(uword maxit = 1000, eT tol = 1e-\/10);}
\DoxyCodeLine{83 }
\DoxyCodeLine{85   \textcolor{keyword}{inline} uword \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_ab7b34e8fe4a2027fc57b787fbb2c9479}{num\_iterations}}() \{ \textcolor{keywordflow}{return} niter; \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{88   \textcolor{keyword}{inline} uword \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a8a1b0364d9b85eead27820e1824624a5}{num\_operations}}() \{ \textcolor{keywordflow}{return} nmatop; \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{91   \textcolor{keyword}{inline} \mbox{\hyperlink{classCol}{Col<eT>}} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_ad725c94b71dfb8132b93bdaba429a73e}{eigenvalues}}();}
\DoxyCodeLine{92 }
\DoxyCodeLine{94   \textcolor{keyword}{inline} \mbox{\hyperlink{classMat}{Mat<eT>}} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a3d90b41b8ef96c137fb7462d30387bc8}{eigenvectors}}(uword nvec);}
\DoxyCodeLine{96   \textcolor{keyword}{inline} \mbox{\hyperlink{classMat}{Mat<eT>}} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a3d90b41b8ef96c137fb7462d30387bc8}{eigenvectors}}() \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classnewarp_1_1SymEigsSolver_a3d90b41b8ef96c137fb7462d30387bc8}{eigenvectors}}(nev); \}}
\DoxyCodeLine{97   \};}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 }
\DoxyCodeLine{100 \}  \textcolor{comment}{// namespace newarp}}

\end{DoxyCode}
