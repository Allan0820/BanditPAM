\hypertarget{newarp__TridiagEigen__meat_8hpp_source}{}\doxysection{newarp\+\_\+\+Tridiag\+Eigen\+\_\+meat.\+hpp}
\label{newarp__TridiagEigen__meat_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_TridiagEigen\_meat.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_TridiagEigen\_meat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }newarp}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{22 \textcolor{keyword}{inline}}
\DoxyCodeLine{23 \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a3b23f2159a42b5aba149a30e93e17d68}{TridiagEigen<eT>::TridiagEigen}}()}
\DoxyCodeLine{24   : n(0)}
\DoxyCodeLine{25   , computed(false)}
\DoxyCodeLine{26   \{}
\DoxyCodeLine{27   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{28   \}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 }
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{33 \textcolor{keyword}{inline}}
\DoxyCodeLine{34 \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a3b23f2159a42b5aba149a30e93e17d68}{TridiagEigen<eT>::TridiagEigen}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& mat\_obj)}
\DoxyCodeLine{35   : n(mat\_obj.n\_rows)}
\DoxyCodeLine{36   , computed(false)}
\DoxyCodeLine{37   \{}
\DoxyCodeLine{38   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{39   }
\DoxyCodeLine{40   \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a14b9dee948a8b36c4ced2e65c759a646}{compute}}(mat\_obj);}
\DoxyCodeLine{41   \}}
\DoxyCodeLine{42 }
\DoxyCodeLine{43 }
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{46 \textcolor{keyword}{inline}}
\DoxyCodeLine{47 \textcolor{keywordtype}{void}}
\DoxyCodeLine{48 \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a14b9dee948a8b36c4ced2e65c759a646}{TridiagEigen<eT>::compute}}(\textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& mat\_obj)}
\DoxyCodeLine{49   \{}
\DoxyCodeLine{50   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{51   }
\DoxyCodeLine{52   arma\_debug\_check( (mat\_obj.\mbox{\hyperlink{group__Mat_ga1f860b22491beb19251642270d04d8f1}{is\_square}}() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}newarp::TridiagEigen::compute(): matrix must be square"{}} );}
\DoxyCodeLine{53   }
\DoxyCodeLine{54   n = blas\_int(mat\_obj.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}});}
\DoxyCodeLine{55   }
\DoxyCodeLine{56   main\_diag = mat\_obj.\mbox{\hyperlink{group__Mat_ga8ab6c07980e1d4c1d90eb3eb7850a2a4}{diag}}();}
\DoxyCodeLine{57   sub\_diag  = mat\_obj.\mbox{\hyperlink{group__Mat_ga8ab6c07980e1d4c1d90eb3eb7850a2a4}{diag}}(-\/1);}
\DoxyCodeLine{58   }
\DoxyCodeLine{59   evecs.set\_size(n, n);}
\DoxyCodeLine{60   }
\DoxyCodeLine{61   \textcolor{keywordtype}{char}     compz      = \textcolor{charliteral}{'I'};}
\DoxyCodeLine{62   blas\_int lwork      = blas\_int(-\/1);}
\DoxyCodeLine{63   eT       lwork\_opt  = eT(0);}
\DoxyCodeLine{64   }
\DoxyCodeLine{65   blas\_int liwork     = blas\_int(-\/1);}
\DoxyCodeLine{66   blas\_int liwork\_opt = blas\_int(0);}
\DoxyCodeLine{67   blas\_int info       = blas\_int(0);}
\DoxyCodeLine{68   }
\DoxyCodeLine{69   \textcolor{comment}{// query for lwork and liwork}}
\DoxyCodeLine{70   lapack::stedc(\&compz, \&n, main\_diag.memptr(), sub\_diag.memptr(), evecs.memptr(), \&n, \&lwork\_opt, \&lwork, \&liwork\_opt, \&liwork, \&info);}
\DoxyCodeLine{71   }
\DoxyCodeLine{72   \textcolor{keywordflow}{if}(info == 0)}
\DoxyCodeLine{73     \{}
\DoxyCodeLine{74     lwork  = blas\_int(lwork\_opt);}
\DoxyCodeLine{75     liwork = liwork\_opt;}
\DoxyCodeLine{76     \}}
\DoxyCodeLine{77   \textcolor{keywordflow}{else}}
\DoxyCodeLine{78     \{}
\DoxyCodeLine{79     lwork  = 1 + 4 * n + n * n;}
\DoxyCodeLine{80     liwork = 3 + 5 * n;}
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82   }
\DoxyCodeLine{83   info = blas\_int(0);}
\DoxyCodeLine{84   }
\DoxyCodeLine{85   \mbox{\hyperlink{classpodarray}{podarray<eT>}}        work(\textcolor{keyword}{static\_cast<}uword\textcolor{keyword}{>}(lwork) );}
\DoxyCodeLine{86   \mbox{\hyperlink{classpodarray}{podarray<blas\_int>}} iwork(\textcolor{keyword}{static\_cast<}uword\textcolor{keyword}{>}(liwork));}
\DoxyCodeLine{87   }
\DoxyCodeLine{88   lapack::stedc(\&compz, \&n, main\_diag.memptr(), sub\_diag.memptr(), evecs.memptr(), \&n, work.memptr(), \&lwork, iwork.memptr(), \&liwork, \&info);}
\DoxyCodeLine{89   }
\DoxyCodeLine{90   \textcolor{keywordflow}{if}(info < 0)  \{ arma\_stop\_logic\_error(\textcolor{stringliteral}{"{}lapack::stedc(): illegal value"{}}); \textcolor{keywordflow}{return}; \}}
\DoxyCodeLine{91   }
\DoxyCodeLine{92   \textcolor{keywordflow}{if}(info > 0)  \{ arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}lapack::stedc(): failed to compute all eigenvalues"{}}); \textcolor{keywordflow}{return}; \}}
\DoxyCodeLine{93   }
\DoxyCodeLine{94   computed = \textcolor{keyword}{true};}
\DoxyCodeLine{95   \}}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 }
\DoxyCodeLine{98 }
\DoxyCodeLine{99 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{100 \textcolor{keyword}{inline}}
\DoxyCodeLine{101 \mbox{\hyperlink{classCol}{Col<eT>}}}
\DoxyCodeLine{102 \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a9fa61ce06193626d6dc4103375e35c93}{TridiagEigen<eT>::eigenvalues}}()}
\DoxyCodeLine{103   \{}
\DoxyCodeLine{104   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{105   }
\DoxyCodeLine{106   arma\_debug\_check( (computed == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}newarp::TridiagEigen::eigenvalues(): need to call compute() first"{}} );}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{comment}{// After calling compute(), main\_diag will contain the eigenvalues.}}
\DoxyCodeLine{109   \textcolor{keywordflow}{return} main\_diag;}
\DoxyCodeLine{110   \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112 }
\DoxyCodeLine{113 }
\DoxyCodeLine{114 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{115 \textcolor{keyword}{inline}}
\DoxyCodeLine{116 \mbox{\hyperlink{classMat}{Mat<eT>}}}
\DoxyCodeLine{117 \mbox{\hyperlink{classnewarp_1_1TridiagEigen_a2626749478daa02be8283717ecbd83c1}{TridiagEigen<eT>::eigenvectors}}()}
\DoxyCodeLine{118   \{}
\DoxyCodeLine{119   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{120   }
\DoxyCodeLine{121   arma\_debug\_check( (computed == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}newarp::TridiagEigen::eigenvectors(): need to call compute() first"{}} );}
\DoxyCodeLine{122 }
\DoxyCodeLine{123   \textcolor{keywordflow}{return} evecs;}
\DoxyCodeLine{124   \}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \}  \textcolor{comment}{// namespace newarp}}

\end{DoxyCode}
