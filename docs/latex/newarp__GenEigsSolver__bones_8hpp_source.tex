\hypertarget{newarp__GenEigsSolver__bones_8hpp_source}{}\doxysection{newarp\+\_\+\+Gen\+Eigs\+Solver\+\_\+bones.\+hpp}
\label{newarp__GenEigsSolver__bones_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_GenEigsSolver\_bones.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/newarp\_GenEigsSolver\_bones.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }newarp}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{22 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keywordtype}{int} SelectionRule, \textcolor{keyword}{typename} OpType>}
\DoxyCodeLine{23 \textcolor{keyword}{class }\mbox{\hyperlink{classnewarp_1_1GenEigsSolver}{GenEigsSolver}}}
\DoxyCodeLine{24   \{}
\DoxyCodeLine{25   \textcolor{keyword}{protected}:}
\DoxyCodeLine{26 }
\DoxyCodeLine{27   \textcolor{keyword}{const} OpType\&           op;        \textcolor{comment}{// object to conduct matrix operation, e.g. matrix-\/vector product}}
\DoxyCodeLine{28   \textcolor{keyword}{const} uword             nev;       \textcolor{comment}{// number of eigenvalues requested}}
\DoxyCodeLine{29   \mbox{\hyperlink{classCol}{Col< std::complex<eT>}} > ritz\_val;  \textcolor{comment}{// ritz values}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31   \textcolor{comment}{// Sort the first nev Ritz pairs in decreasing magnitude order}}
\DoxyCodeLine{32   \textcolor{comment}{// This is used to return the final results}}
\DoxyCodeLine{33   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} sort\_ritzpair();}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{keyword}{private}:}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   \textcolor{keyword}{const} uword             dim\_n;     \textcolor{comment}{// dimension of matrix A}}
\DoxyCodeLine{39   \textcolor{keyword}{const} uword             ncv;       \textcolor{comment}{// number of ritz values}}
\DoxyCodeLine{40   uword                   nmatop;    \textcolor{comment}{// number of matrix operations called}}
\DoxyCodeLine{41   uword                   niter;     \textcolor{comment}{// number of restarting iterations}}
\DoxyCodeLine{42   \mbox{\hyperlink{classMat}{Mat<eT>}}                 fac\_V;     \textcolor{comment}{// V matrix in the Arnoldi factorisation}}
\DoxyCodeLine{43   \mbox{\hyperlink{classMat}{Mat<eT>}}                 fac\_H;     \textcolor{comment}{// H matrix in the Arnoldi factorisation}}
\DoxyCodeLine{44   \mbox{\hyperlink{classCol}{Col<eT>}}                 fac\_f;     \textcolor{comment}{// residual in the Arnoldi factorisation}}
\DoxyCodeLine{45   \mbox{\hyperlink{classMat}{Mat< std::complex<eT>}} > ritz\_vec;  \textcolor{comment}{// ritz vectors}}
\DoxyCodeLine{46   \mbox{\hyperlink{classCol}{Col< std::complex<eT>}} > ritz\_est;  \textcolor{comment}{// last row of ritz\_vec}}
\DoxyCodeLine{47   std::vector<bool>       ritz\_conv; \textcolor{comment}{// indicator of the convergence of ritz values}}
\DoxyCodeLine{48   \textcolor{keyword}{const} eT                eps;       \textcolor{comment}{// the machine precision}}
\DoxyCodeLine{49                                      \textcolor{comment}{// e.g. \string~= 1e-\/16 for double type}}
\DoxyCodeLine{50   \textcolor{keyword}{const} eT                approx0;   \textcolor{comment}{// a number that is approximately zero}}
\DoxyCodeLine{51                                      \textcolor{comment}{// approx0 = eps\string^(2/3)}}
\DoxyCodeLine{52                                      \textcolor{comment}{// used to test the orthogonality of vectors,}}
\DoxyCodeLine{53                                      \textcolor{comment}{// and in convergence test, tol*approx0 is}}
\DoxyCodeLine{54                                      \textcolor{comment}{// the absolute tolerance}}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   \textcolor{comment}{// Arnoldi factorisation starting from step-\/k}}
\DoxyCodeLine{57   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} factorise\_from(uword from\_k, uword to\_m, \textcolor{keyword}{const} \mbox{\hyperlink{classCol}{Col<eT>}}\& fk);}
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{comment}{// Implicitly restarted Arnoldi factorisation}}
\DoxyCodeLine{60   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} restart(uword k);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{comment}{// Calculate the number of converged Ritz values}}
\DoxyCodeLine{63   \textcolor{keyword}{inline} uword num\_converged(eT tol);}
\DoxyCodeLine{64 }
\DoxyCodeLine{65   \textcolor{comment}{// Return the adjusted nev for restarting}}
\DoxyCodeLine{66   \textcolor{keyword}{inline} uword nev\_adjusted(uword nconv);}
\DoxyCodeLine{67 }
\DoxyCodeLine{68   \textcolor{comment}{// Retrieve and sort ritz values and ritz vectors}}
\DoxyCodeLine{69   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} retrieve\_ritzpair();}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{keyword}{public}:}
\DoxyCodeLine{73 }
\DoxyCodeLine{75   \textcolor{keyword}{inline} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a830bc163b8b3b8048014189728f83f09}{GenEigsSolver}}(\textcolor{keyword}{const} OpType\& \mbox{\hyperlink{structop__}{op\_}}, uword nev\_, uword ncv\_);}
\DoxyCodeLine{76 }
\DoxyCodeLine{78   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a6428da85b23c40f39cc50205100b4f81}{init}}(eT* init\_resid);}
\DoxyCodeLine{79 }
\DoxyCodeLine{81   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a6428da85b23c40f39cc50205100b4f81}{init}}();}
\DoxyCodeLine{82 }
\DoxyCodeLine{84   \textcolor{keyword}{inline} uword \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a74887ae9a3a007651d81b37c83a2a8fa}{compute}}(uword maxit = 1000, eT tol = 1e-\/10);}
\DoxyCodeLine{85 }
\DoxyCodeLine{87   \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a103cc14b039ce5bd12c0b6f839885feb}{num\_iterations}}() \{ \textcolor{keywordflow}{return} niter; \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{90   \textcolor{keyword}{inline} \textcolor{keywordtype}{int} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a50dc383119d6e50aa083ddce8fe72d4e}{num\_operations}}() \{ \textcolor{keywordflow}{return} nmatop; \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{93   \textcolor{keyword}{inline} \mbox{\hyperlink{classCol}{Col< std::complex<eT>}} > \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a2a784c05989cbd43d23296bb92c35619}{eigenvalues}}();}
\DoxyCodeLine{94 }
\DoxyCodeLine{96   \textcolor{keyword}{inline} \mbox{\hyperlink{classMat}{Mat< std::complex<eT>}} > \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a845d3adcbc1e0870f33572942c75c12f}{eigenvectors}}(uword nvec);}
\DoxyCodeLine{97   }
\DoxyCodeLine{99   \textcolor{keyword}{inline} \mbox{\hyperlink{classMat}{Mat< std::complex<eT>}} > \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a845d3adcbc1e0870f33572942c75c12f}{eigenvectors}}() \{ \textcolor{keywordflow}{return} \mbox{\hyperlink{classnewarp_1_1GenEigsSolver_a845d3adcbc1e0870f33572942c75c12f}{eigenvectors}}(nev); \}}
\DoxyCodeLine{100   \};}
\DoxyCodeLine{101 }
\DoxyCodeLine{102 }
\DoxyCodeLine{103 \}  \textcolor{comment}{// namespace newarp}}

\end{DoxyCode}
