\hypertarget{op__wishrnd__meat_8hpp_source}{}\doxysection{op\+\_\+wishrnd\+\_\+meat.\+hpp}
\label{op__wishrnd__meat_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/op\_wishrnd\_meat.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/op\_wishrnd\_meat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{comment}{// implementation based on:}}
\DoxyCodeLine{22 \textcolor{comment}{// Yu-\/Cheng Ku and Peter Bloomfield.}}
\DoxyCodeLine{23 \textcolor{comment}{// Generating Random Wishart Matrices with Fractional Degrees of Freedom in OX.}}
\DoxyCodeLine{24 \textcolor{comment}{// Oxmetrics User Conference, 2010.}}
\DoxyCodeLine{25   }
\DoxyCodeLine{26 }
\DoxyCodeLine{27 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1>}
\DoxyCodeLine{28 \textcolor{keyword}{inline}}
\DoxyCodeLine{29 \textcolor{keywordtype}{void}}
\DoxyCodeLine{30 op\_wishrnd::apply(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classOp}{Op<T1,op\_wishrnd>}}\& expr)}
\DoxyCodeLine{31   \{}
\DoxyCodeLine{32   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{33   }
\DoxyCodeLine{34   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT;}
\DoxyCodeLine{35   }
\DoxyCodeLine{36   \textcolor{keyword}{const} eT    df   = expr.\mbox{\hyperlink{classOp_a6bedb670e7a17e7f713333b55aaacf9a}{aux}};}
\DoxyCodeLine{37   \textcolor{keyword}{const} uword mode = expr.\mbox{\hyperlink{classOp_a197cb9330fe0d72c976d6223514c4bd6}{aux\_uword\_a}};}
\DoxyCodeLine{38   }
\DoxyCodeLine{39   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = op\_wishrnd::apply\_direct(out, expr.\mbox{\hyperlink{classOp_af7ab7221b6e233cdd38b9f9b69f301ce}{m}}, df, mode);}
\DoxyCodeLine{40   }
\DoxyCodeLine{41   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{42     \{}
\DoxyCodeLine{43     out.soft\_reset();}
\DoxyCodeLine{44     arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}wishrnd(): given matrix is not symmetric positive definite"{}});}
\DoxyCodeLine{45     \}}
\DoxyCodeLine{46   \}}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 }
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1>}
\DoxyCodeLine{51 \textcolor{keyword}{inline}}
\DoxyCodeLine{52 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{53 op\_wishrnd::apply\_direct(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<typename T1::elem\_type,T1>}}\& X, \textcolor{keyword}{const} \textcolor{keyword}{typename} T1::elem\_type df, \textcolor{keyword}{const} uword mode)}
\DoxyCodeLine{54   \{}
\DoxyCodeLine{55   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{56   }
\DoxyCodeLine{57   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT;}
\DoxyCodeLine{58   }
\DoxyCodeLine{59   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} U(X.get\_ref());}
\DoxyCodeLine{60   }
\DoxyCodeLine{61   \textcolor{keywordtype}{bool} status = \textcolor{keyword}{false};}
\DoxyCodeLine{62   }
\DoxyCodeLine{63   \textcolor{keywordflow}{if}(U.is\_alias(out))}
\DoxyCodeLine{64     \{}
\DoxyCodeLine{65     \mbox{\hyperlink{classMat}{Mat<eT>}} tmp;}
\DoxyCodeLine{66     }
\DoxyCodeLine{67     \textcolor{keywordflow}{if}(mode == 1)  \{ status = op\_wishrnd::apply\_noalias\_mode1(tmp, U.M, df); \}}
\DoxyCodeLine{68     \textcolor{keywordflow}{if}(mode == 2)  \{ status = op\_wishrnd::apply\_noalias\_mode2(tmp, U.M, df); \}}
\DoxyCodeLine{69     }
\DoxyCodeLine{70     out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(tmp);}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72   \textcolor{keywordflow}{else}}
\DoxyCodeLine{73     \{}
\DoxyCodeLine{74     \textcolor{keywordflow}{if}(mode == 1)  \{ status = op\_wishrnd::apply\_noalias\_mode1(out, U.M, df); \}}
\DoxyCodeLine{75     \textcolor{keywordflow}{if}(mode == 2)  \{ status = op\_wishrnd::apply\_noalias\_mode2(out, U.M, df); \}}
\DoxyCodeLine{76     \}}
\DoxyCodeLine{77   }
\DoxyCodeLine{78   \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{79   \}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81 }
\DoxyCodeLine{82 }
\DoxyCodeLine{83 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{84 \textcolor{keyword}{inline}}
\DoxyCodeLine{85 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{86 op\_wishrnd::apply\_noalias\_mode1(\mbox{\hyperlink{classMat}{Mat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& S, \textcolor{keyword}{const} eT df)}
\DoxyCodeLine{87   \{}
\DoxyCodeLine{88   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{89   }
\DoxyCodeLine{90   arma\_debug\_check( (S.\mbox{\hyperlink{group__Mat_ga1f860b22491beb19251642270d04d8f1}{is\_square}}() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}wishrnd(): given matrix must be square sized"{}} );}
\DoxyCodeLine{91   }
\DoxyCodeLine{92   \textcolor{keywordflow}{if}(S.\mbox{\hyperlink{group__Mat_ga3008049216e02308ff665862f451a7ff}{is\_empty}}())  \{ out.reset(); \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{93   }
\DoxyCodeLine{94   \textcolor{keywordflow}{if}(auxlib::rudimentary\_sym\_check(S) == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{95   }
\DoxyCodeLine{96   \mbox{\hyperlink{classMat}{Mat<eT>}} D;}
\DoxyCodeLine{97   }
\DoxyCodeLine{98   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = op\_chol::apply\_direct(D, S, 0);}
\DoxyCodeLine{99   }
\DoxyCodeLine{100   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{101   }
\DoxyCodeLine{102   \textcolor{keywordflow}{return} op\_wishrnd::apply\_noalias\_mode2(out, D, df);}
\DoxyCodeLine{103   \}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105 }
\DoxyCodeLine{106 }
\DoxyCodeLine{107 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{108 \textcolor{keyword}{inline}}
\DoxyCodeLine{109 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{110 op\_wishrnd::apply\_noalias\_mode2(\mbox{\hyperlink{classMat}{Mat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& D, \textcolor{keyword}{const} eT df)}
\DoxyCodeLine{111   \{}
\DoxyCodeLine{112   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{113   }
\DoxyCodeLine{114   arma\_debug\_check( (df <= eT(0)),            \textcolor{stringliteral}{"{}df must be greater than zero"{}}                 );}
\DoxyCodeLine{115   arma\_debug\_check( (D.\mbox{\hyperlink{group__Mat_ga1f860b22491beb19251642270d04d8f1}{is\_square}}() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}wishrnd(): given matrix must be square sized"{}} );}
\DoxyCodeLine{116   }
\DoxyCodeLine{117   \textcolor{keywordflow}{if}(D.\mbox{\hyperlink{group__Mat_ga3008049216e02308ff665862f451a7ff}{is\_empty}}())  \{ out.reset(); \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{118   }
\DoxyCodeLine{119   \textcolor{keyword}{const} uword N = D.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}};}
\DoxyCodeLine{120   }
\DoxyCodeLine{121   \textcolor{keywordflow}{if}(df < eT(N))}
\DoxyCodeLine{122     \{}
\DoxyCodeLine{123     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}simple generator"{}});}
\DoxyCodeLine{124     }
\DoxyCodeLine{125     \textcolor{keyword}{const} uword df\_floor = uword(std::floor(df));}
\DoxyCodeLine{126     }
\DoxyCodeLine{127     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}} tmp = (randn< Mat<eT> >(df\_floor, N)) * D;}
\DoxyCodeLine{128     }
\DoxyCodeLine{129     out = tmp.t() * tmp;}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131   \textcolor{keywordflow}{else}}
\DoxyCodeLine{132     \{}
\DoxyCodeLine{133     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}standard generator"{}});}
\DoxyCodeLine{134     }
\DoxyCodeLine{135     \mbox{\hyperlink{classop__chi2rnd__varying__df}{op\_chi2rnd\_varying\_df<eT>}} chi2rnd\_generator;}
\DoxyCodeLine{136     }
\DoxyCodeLine{137     \mbox{\hyperlink{classMat}{Mat<eT>}} \mbox{\hyperlink{structA}{A}}(N, N, \mbox{\hyperlink{structarma__zeros__indicator}{arma\_zeros\_indicator}}());}
\DoxyCodeLine{138     }
\DoxyCodeLine{139     \textcolor{keywordflow}{for}(uword i=0; i<N; ++i)}
\DoxyCodeLine{140       \{}
\DoxyCodeLine{141       \mbox{\hyperlink{structA}{A}}.at(i,i) = std::sqrt( chi2rnd\_generator(df -\/ eT(i)) );}
\DoxyCodeLine{142       \}}
\DoxyCodeLine{143     }
\DoxyCodeLine{144     \textcolor{keywordflow}{for}(uword i=1; i < N; ++i)}
\DoxyCodeLine{145       \{}
\DoxyCodeLine{146       \mbox{\hyperlink{structarma__rng_1_1randn}{arma\_rng::randn<eT>::fill}}( \mbox{\hyperlink{structA}{A}}.colptr(i), i );}
\DoxyCodeLine{147       \}}
\DoxyCodeLine{148     }
\DoxyCodeLine{149     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}} tmp = \mbox{\hyperlink{structA}{A}} * D;}
\DoxyCodeLine{150     }
\DoxyCodeLine{151     \mbox{\hyperlink{structA}{A}}.reset();}
\DoxyCodeLine{152     }
\DoxyCodeLine{153     out = tmp.t() * tmp;}
\DoxyCodeLine{154     \}}
\DoxyCodeLine{155   }
\DoxyCodeLine{156   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{157   \}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 }
\DoxyCodeLine{160 }
\DoxyCodeLine{161 \textcolor{comment}{//}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 }
\DoxyCodeLine{164 }
\DoxyCodeLine{165 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1>}
\DoxyCodeLine{166 \textcolor{keyword}{inline}}
\DoxyCodeLine{167 \textcolor{keywordtype}{void}}
\DoxyCodeLine{168 op\_iwishrnd::apply(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classOp}{Op<T1,op\_iwishrnd>}}\& expr)}
\DoxyCodeLine{169   \{}
\DoxyCodeLine{170   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{171   }
\DoxyCodeLine{172   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT;}
\DoxyCodeLine{173   }
\DoxyCodeLine{174   \textcolor{keyword}{const} eT    df   = expr.\mbox{\hyperlink{classOp_a6bedb670e7a17e7f713333b55aaacf9a}{aux}};}
\DoxyCodeLine{175   \textcolor{keyword}{const} uword mode = expr.\mbox{\hyperlink{classOp_a197cb9330fe0d72c976d6223514c4bd6}{aux\_uword\_a}};}
\DoxyCodeLine{176   }
\DoxyCodeLine{177   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = op\_iwishrnd::apply\_direct(out, expr.\mbox{\hyperlink{classOp_af7ab7221b6e233cdd38b9f9b69f301ce}{m}}, df, mode);}
\DoxyCodeLine{178   }
\DoxyCodeLine{179   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{180     \{}
\DoxyCodeLine{181     out.soft\_reset();}
\DoxyCodeLine{182     arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}iwishrnd(): given matrix is not symmetric positive definite and/or df is too low"{}});}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184   \}}
\DoxyCodeLine{185 }
\DoxyCodeLine{186 }
\DoxyCodeLine{187 }
\DoxyCodeLine{188 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1>}
\DoxyCodeLine{189 \textcolor{keyword}{inline}}
\DoxyCodeLine{190 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{191 op\_iwishrnd::apply\_direct(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<typename T1::elem\_type,T1>}}\& X, \textcolor{keyword}{const} \textcolor{keyword}{typename} T1::elem\_type df, \textcolor{keyword}{const} uword mode)}
\DoxyCodeLine{192   \{}
\DoxyCodeLine{193   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{194   }
\DoxyCodeLine{195   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT;}
\DoxyCodeLine{196   }
\DoxyCodeLine{197   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} U(X.get\_ref());}
\DoxyCodeLine{198   }
\DoxyCodeLine{199   \textcolor{keywordtype}{bool} status = \textcolor{keyword}{false};}
\DoxyCodeLine{200   }
\DoxyCodeLine{201   \textcolor{keywordflow}{if}(U.is\_alias(out))}
\DoxyCodeLine{202     \{}
\DoxyCodeLine{203     \mbox{\hyperlink{classMat}{Mat<eT>}} tmp;}
\DoxyCodeLine{204     }
\DoxyCodeLine{205     \textcolor{keywordflow}{if}(mode == 1)  \{ status = op\_iwishrnd::apply\_noalias\_mode1(tmp, U.M, df); \}}
\DoxyCodeLine{206     \textcolor{keywordflow}{if}(mode == 2)  \{ status = op\_iwishrnd::apply\_noalias\_mode2(tmp, U.M, df); \}}
\DoxyCodeLine{207     }
\DoxyCodeLine{208     out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(tmp);}
\DoxyCodeLine{209     \}}
\DoxyCodeLine{210   \textcolor{keywordflow}{else}}
\DoxyCodeLine{211     \{}
\DoxyCodeLine{212     \textcolor{keywordflow}{if}(mode == 1)  \{ status = op\_iwishrnd::apply\_noalias\_mode1(out, U.M, df); \}}
\DoxyCodeLine{213     \textcolor{keywordflow}{if}(mode == 2)  \{ status = op\_iwishrnd::apply\_noalias\_mode2(out, U.M, df); \}}
\DoxyCodeLine{214     \}}
\DoxyCodeLine{215   }
\DoxyCodeLine{216   \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{217   \}}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 }
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{222 \textcolor{keyword}{inline}}
\DoxyCodeLine{223 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{224 op\_iwishrnd::apply\_noalias\_mode1(\mbox{\hyperlink{classMat}{Mat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& T, \textcolor{keyword}{const} eT df)}
\DoxyCodeLine{225   \{}
\DoxyCodeLine{226   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{227   }
\DoxyCodeLine{228   arma\_debug\_check( (T.\mbox{\hyperlink{group__Mat_ga1f860b22491beb19251642270d04d8f1}{is\_square}}() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}iwishrnd(): given matrix must be square sized"{}} );}
\DoxyCodeLine{229   }
\DoxyCodeLine{230   \textcolor{keywordflow}{if}(T.\mbox{\hyperlink{group__Mat_ga3008049216e02308ff665862f451a7ff}{is\_empty}}())  \{ out.reset(); \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{231   }
\DoxyCodeLine{232   \textcolor{keywordflow}{if}(auxlib::rudimentary\_sym\_check(T) == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{233   }
\DoxyCodeLine{234   \mbox{\hyperlink{classMat}{Mat<eT>}} Tinv;}
\DoxyCodeLine{235   \mbox{\hyperlink{classMat}{Mat<eT>}} Dinv;}
\DoxyCodeLine{236   }
\DoxyCodeLine{237   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} inv\_status = auxlib::inv\_sympd(Tinv, T);}
\DoxyCodeLine{238   }
\DoxyCodeLine{239   \textcolor{keywordflow}{if}(inv\_status == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{240   }
\DoxyCodeLine{241   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} chol\_status = op\_chol::apply\_direct(Dinv, Tinv, 0);}
\DoxyCodeLine{242   }
\DoxyCodeLine{243   \textcolor{keywordflow}{if}(chol\_status == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{244   }
\DoxyCodeLine{245   \textcolor{keywordflow}{return} op\_iwishrnd::apply\_noalias\_mode2(out, Dinv, df);}
\DoxyCodeLine{246   \}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248 }
\DoxyCodeLine{249 }
\DoxyCodeLine{250 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{251 \textcolor{keyword}{inline}}
\DoxyCodeLine{252 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{253 op\_iwishrnd::apply\_noalias\_mode2(\mbox{\hyperlink{classMat}{Mat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& Dinv, \textcolor{keyword}{const} eT df)}
\DoxyCodeLine{254   \{}
\DoxyCodeLine{255   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{256   }
\DoxyCodeLine{257   arma\_debug\_check( (df <= eT(0)),               \textcolor{stringliteral}{"{}df must be greater than zero"{}}                  );}
\DoxyCodeLine{258   arma\_debug\_check( (Dinv.\mbox{\hyperlink{group__Mat_ga1f860b22491beb19251642270d04d8f1}{is\_square}}() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}iwishrnd(): given matrix must be square sized"{}} );}
\DoxyCodeLine{259   }
\DoxyCodeLine{260   \textcolor{keywordflow}{if}(Dinv.\mbox{\hyperlink{group__Mat_ga3008049216e02308ff665862f451a7ff}{is\_empty}}())  \{ out.reset(); \textcolor{keywordflow}{return} \textcolor{keyword}{true}; \}}
\DoxyCodeLine{261   }
\DoxyCodeLine{262   \mbox{\hyperlink{classMat}{Mat<eT>}} tmp;}
\DoxyCodeLine{263   }
\DoxyCodeLine{264   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} wishrnd\_status = op\_wishrnd::apply\_noalias\_mode2(tmp, Dinv, df);}
\DoxyCodeLine{265   }
\DoxyCodeLine{266   \textcolor{keywordflow}{if}(wishrnd\_status == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{267   }
\DoxyCodeLine{268   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} inv\_status1 = auxlib::inv\_sympd(out, tmp);}
\DoxyCodeLine{269   }
\DoxyCodeLine{270   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} inv\_status2 = (inv\_status1) ? \textcolor{keywordtype}{bool}(\textcolor{keyword}{true}) : bool(auxlib::inv(out, tmp));}
\DoxyCodeLine{271   }
\DoxyCodeLine{272   \textcolor{keywordflow}{if}(inv\_status2 == \textcolor{keyword}{false})  \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \}}
\DoxyCodeLine{273   }
\DoxyCodeLine{274   \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{275   \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277 }
\DoxyCodeLine{278 }

\end{DoxyCode}
