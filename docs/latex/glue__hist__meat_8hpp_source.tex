\hypertarget{glue__hist__meat_8hpp_source}{}\doxysection{glue\+\_\+hist\+\_\+meat.\+hpp}
\label{glue__hist__meat_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/glue\_hist\_meat.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/glue\_hist\_meat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{22 \textcolor{keyword}{inline}}
\DoxyCodeLine{23 \textcolor{keywordtype}{void}}
\DoxyCodeLine{24 glue\_hist::apply\_noalias(\mbox{\hyperlink{classMat}{Mat<uword>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& X, \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& C, \textcolor{keyword}{const} uword dim)}
\DoxyCodeLine{25   \{}
\DoxyCodeLine{26   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{27   }
\DoxyCodeLine{28   arma\_debug\_check( ((C.\mbox{\hyperlink{group__Mat_ga87639faacb2a4bfd8cbc80d23b993edf}{is\_vec}}() == \textcolor{keyword}{false}) \&\& (C.\mbox{\hyperlink{group__Mat_ga3008049216e02308ff665862f451a7ff}{is\_empty}}() == \textcolor{keyword}{false})), \textcolor{stringliteral}{"{}hist(): parameter 'centers' must be a vector"{}} );}
\DoxyCodeLine{29   }
\DoxyCodeLine{30   \textcolor{keyword}{const} uword X\_n\_rows = X.n\_rows;}
\DoxyCodeLine{31   \textcolor{keyword}{const} uword X\_n\_cols = X.n\_cols;}
\DoxyCodeLine{32   }
\DoxyCodeLine{33   \textcolor{keyword}{const} uword C\_n\_elem = C.\mbox{\hyperlink{classMat_a89f0d40af94b6521edd06645a0d68fd4}{n\_elem}};}
\DoxyCodeLine{34   }
\DoxyCodeLine{35   \textcolor{keywordflow}{if}( C\_n\_elem == 0 )  \{ out.reset(); \textcolor{keywordflow}{return}; \}}
\DoxyCodeLine{36   }
\DoxyCodeLine{37   arma\_debug\_check}
\DoxyCodeLine{38     (}
\DoxyCodeLine{39     ((\mbox{\hyperlink{classCol}{Col<eT>}}(\textcolor{keyword}{const\_cast<}eT*\textcolor{keyword}{>}(C.\mbox{\hyperlink{group__Mat_gad5b1b46a9288e04128aa11c99cc2b444}{memptr}}()), C\_n\_elem, \textcolor{keyword}{false}, \textcolor{keyword}{false})).is\_sorted(\textcolor{stringliteral}{"{}strictascend"{}}) == \textcolor{keyword}{false}),}
\DoxyCodeLine{40     \textcolor{stringliteral}{"{}hist(): given 'centers' vector does not contain monotonically increasing values"{}}}
\DoxyCodeLine{41     );}
\DoxyCodeLine{42   }
\DoxyCodeLine{43   \textcolor{keyword}{const} eT* C\_mem    = C.\mbox{\hyperlink{group__Mat_gad5b1b46a9288e04128aa11c99cc2b444}{memptr}}();}
\DoxyCodeLine{44   \textcolor{keyword}{const} eT  center\_0 = C\_mem[0];}
\DoxyCodeLine{45   }
\DoxyCodeLine{46   \textcolor{keywordflow}{if}(dim == 0)}
\DoxyCodeLine{47     \{}
\DoxyCodeLine{48     out.zeros(C\_n\_elem, X\_n\_cols);}
\DoxyCodeLine{49     }
\DoxyCodeLine{50     \textcolor{keywordflow}{for}(uword col=0; col < X\_n\_cols; ++col)}
\DoxyCodeLine{51       \{}
\DoxyCodeLine{52       \textcolor{keyword}{const} eT*    X\_coldata   = X.colptr(col);}
\DoxyCodeLine{53             uword* out\_coldata = out.\mbox{\hyperlink{group__Mat_gad6a294c2ed4726f7b4b95e750ddfeb7a}{colptr}}(col);}
\DoxyCodeLine{54       }
\DoxyCodeLine{55       \textcolor{keywordflow}{for}(uword row=0; row < X\_n\_rows; ++row)}
\DoxyCodeLine{56         \{}
\DoxyCodeLine{57         \textcolor{keyword}{const} eT val = X\_coldata[row];}
\DoxyCodeLine{58         }
\DoxyCodeLine{59         \textcolor{keywordflow}{if}(arma\_isfinite(val))}
\DoxyCodeLine{60           \{}
\DoxyCodeLine{61           eT    opt\_dist  = (center\_0 >= val) ? (center\_0 -\/ val) : (val -\/ center\_0);}
\DoxyCodeLine{62           uword opt\_index = 0;}
\DoxyCodeLine{63           }
\DoxyCodeLine{64           \textcolor{keywordflow}{for}(uword j=1; j < C\_n\_elem; ++j)}
\DoxyCodeLine{65             \{}
\DoxyCodeLine{66             \textcolor{keyword}{const} eT center = C\_mem[j];}
\DoxyCodeLine{67             \textcolor{keyword}{const} eT dist   = (center >= val) ? (center -\/ val) : (val -\/ center);}
\DoxyCodeLine{68             }
\DoxyCodeLine{69             \textcolor{keywordflow}{if}(dist < opt\_dist)}
\DoxyCodeLine{70               \{}
\DoxyCodeLine{71               opt\_dist  = dist;}
\DoxyCodeLine{72               opt\_index = j;}
\DoxyCodeLine{73               \}}
\DoxyCodeLine{74             \textcolor{keywordflow}{else}}
\DoxyCodeLine{75               \{}
\DoxyCodeLine{76               \textcolor{keywordflow}{break};}
\DoxyCodeLine{77               \}}
\DoxyCodeLine{78             \}}
\DoxyCodeLine{79           }
\DoxyCodeLine{80           out\_coldata[opt\_index]++;}
\DoxyCodeLine{81           \}}
\DoxyCodeLine{82         \textcolor{keywordflow}{else}}
\DoxyCodeLine{83           \{}
\DoxyCodeLine{84           \textcolor{comment}{// -\/inf}}
\DoxyCodeLine{85           \textcolor{keywordflow}{if}(val < eT(0)) \{ out\_coldata[0]++; \}}
\DoxyCodeLine{86           }
\DoxyCodeLine{87           \textcolor{comment}{// +inf}}
\DoxyCodeLine{88           \textcolor{keywordflow}{if}(val > eT(0)) \{ out\_coldata[C\_n\_elem-\/1]++; \}}
\DoxyCodeLine{89           }
\DoxyCodeLine{90           \textcolor{comment}{// ignore NaN}}
\DoxyCodeLine{91           \}}
\DoxyCodeLine{92         \}}
\DoxyCodeLine{93       \}}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95   \textcolor{keywordflow}{else}}
\DoxyCodeLine{96   \textcolor{keywordflow}{if}(dim == 1)}
\DoxyCodeLine{97     \{}
\DoxyCodeLine{98     out.zeros(X\_n\_rows, C\_n\_elem);}
\DoxyCodeLine{99     }
\DoxyCodeLine{100     \textcolor{keywordflow}{if}(X\_n\_rows == 1)}
\DoxyCodeLine{101       \{}
\DoxyCodeLine{102       \textcolor{keyword}{const} uword  X\_n\_elem = X.n\_elem;}
\DoxyCodeLine{103       \textcolor{keyword}{const} eT*    X\_mem    = X.memptr();}
\DoxyCodeLine{104             uword* out\_mem  = out.\mbox{\hyperlink{group__Mat_gad5b1b46a9288e04128aa11c99cc2b444}{memptr}}();}
\DoxyCodeLine{105       }
\DoxyCodeLine{106       \textcolor{keywordflow}{for}(uword i=0; i < X\_n\_elem; ++i)}
\DoxyCodeLine{107         \{}
\DoxyCodeLine{108         \textcolor{keyword}{const} eT val = X\_mem[i];}
\DoxyCodeLine{109         }
\DoxyCodeLine{110         \textcolor{keywordflow}{if}(\mbox{\hyperlink{group__fn__misc_ga2cfbda9ab3edef6a9f0981bcb62174e3}{is\_finite}}(val))}
\DoxyCodeLine{111           \{}
\DoxyCodeLine{112           eT    opt\_dist  = (val >= center\_0) ? (val -\/ center\_0) : (center\_0 -\/ val);}
\DoxyCodeLine{113           uword opt\_index = 0;}
\DoxyCodeLine{114           }
\DoxyCodeLine{115           \textcolor{keywordflow}{for}(uword j=1; j < C\_n\_elem; ++j)}
\DoxyCodeLine{116             \{}
\DoxyCodeLine{117             \textcolor{keyword}{const} eT center = C\_mem[j];}
\DoxyCodeLine{118             \textcolor{keyword}{const} eT dist   = (val >= center) ? (val -\/ center) : (center -\/ val);}
\DoxyCodeLine{119             }
\DoxyCodeLine{120             \textcolor{keywordflow}{if}(dist < opt\_dist)}
\DoxyCodeLine{121               \{}
\DoxyCodeLine{122               opt\_dist  = dist;}
\DoxyCodeLine{123               opt\_index = j;}
\DoxyCodeLine{124               \}}
\DoxyCodeLine{125             \textcolor{keywordflow}{else}}
\DoxyCodeLine{126               \{}
\DoxyCodeLine{127               \textcolor{keywordflow}{break};}
\DoxyCodeLine{128               \}}
\DoxyCodeLine{129             \}}
\DoxyCodeLine{130           }
\DoxyCodeLine{131           out\_mem[opt\_index]++;}
\DoxyCodeLine{132           \}}
\DoxyCodeLine{133         \textcolor{keywordflow}{else}}
\DoxyCodeLine{134           \{}
\DoxyCodeLine{135           \textcolor{comment}{// -\/inf}}
\DoxyCodeLine{136           \textcolor{keywordflow}{if}(val < eT(0)) \{ out\_mem[0]++; \}}
\DoxyCodeLine{137           }
\DoxyCodeLine{138           \textcolor{comment}{// +inf}}
\DoxyCodeLine{139           \textcolor{keywordflow}{if}(val > eT(0)) \{ out\_mem[C\_n\_elem-\/1]++; \}}
\DoxyCodeLine{140           }
\DoxyCodeLine{141           \textcolor{comment}{// ignore NaN}}
\DoxyCodeLine{142           \}}
\DoxyCodeLine{143         \}}
\DoxyCodeLine{144       \}}
\DoxyCodeLine{145     \textcolor{keywordflow}{else}}
\DoxyCodeLine{146       \{}
\DoxyCodeLine{147       \textcolor{keywordflow}{for}(uword row=0; row < X\_n\_rows; ++row)}
\DoxyCodeLine{148         \{}
\DoxyCodeLine{149         \textcolor{keywordflow}{for}(uword col=0; col < X\_n\_cols; ++col)}
\DoxyCodeLine{150           \{}
\DoxyCodeLine{151           \textcolor{keyword}{const} eT val = X.at(row,col);}
\DoxyCodeLine{152           }
\DoxyCodeLine{153           \textcolor{keywordflow}{if}(arma\_isfinite(val))}
\DoxyCodeLine{154             \{}
\DoxyCodeLine{155             eT    opt\_dist  = (center\_0 >= val) ? (center\_0 -\/ val) : (val -\/ center\_0);}
\DoxyCodeLine{156             uword opt\_index = 0;}
\DoxyCodeLine{157             }
\DoxyCodeLine{158             \textcolor{keywordflow}{for}(uword j=1; j < C\_n\_elem; ++j)}
\DoxyCodeLine{159               \{}
\DoxyCodeLine{160               \textcolor{keyword}{const} eT center = C\_mem[j];}
\DoxyCodeLine{161               \textcolor{keyword}{const} eT dist   = (center >= val) ? (center -\/ val) : (val -\/ center);}
\DoxyCodeLine{162               }
\DoxyCodeLine{163               \textcolor{keywordflow}{if}(dist < opt\_dist)}
\DoxyCodeLine{164                 \{}
\DoxyCodeLine{165                 opt\_dist  = dist;}
\DoxyCodeLine{166                 opt\_index = j;}
\DoxyCodeLine{167                 \}}
\DoxyCodeLine{168               \textcolor{keywordflow}{else}}
\DoxyCodeLine{169                 \{}
\DoxyCodeLine{170                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{171                 \}}
\DoxyCodeLine{172               \}}
\DoxyCodeLine{173             }
\DoxyCodeLine{174             out.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row,opt\_index)++;}
\DoxyCodeLine{175             \}}
\DoxyCodeLine{176           \textcolor{keywordflow}{else}}
\DoxyCodeLine{177             \{}
\DoxyCodeLine{178             \textcolor{comment}{// -\/inf}}
\DoxyCodeLine{179             \textcolor{keywordflow}{if}(val < eT(0)) \{ out.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row,0)++; \}}
\DoxyCodeLine{180             }
\DoxyCodeLine{181             \textcolor{comment}{// +inf}}
\DoxyCodeLine{182             \textcolor{keywordflow}{if}(val > eT(0)) \{ out.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row,C\_n\_elem-\/1)++; \}}
\DoxyCodeLine{183             }
\DoxyCodeLine{184             \textcolor{comment}{// ignore NaN}}
\DoxyCodeLine{185             \}}
\DoxyCodeLine{186           \}}
\DoxyCodeLine{187         \}}
\DoxyCodeLine{188       \}}
\DoxyCodeLine{189     \}}
\DoxyCodeLine{190   \}}
\DoxyCodeLine{191 }
\DoxyCodeLine{192 }
\DoxyCodeLine{193 }
\DoxyCodeLine{194 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{195 \textcolor{keyword}{inline}}
\DoxyCodeLine{196 \textcolor{keywordtype}{void}}
\DoxyCodeLine{197 glue\_hist::apply(\mbox{\hyperlink{classMat}{Mat<uword>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classmtGlue}{mtGlue<uword,T1,T2,glue\_hist>}}\& expr)}
\DoxyCodeLine{198   \{}
\DoxyCodeLine{199   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{200   }
\DoxyCodeLine{201   \textcolor{keyword}{const} uword dim = expr.\mbox{\hyperlink{classmtGlue_ad18cf3b7394987c4983dd88ba7ed9a61}{aux\_uword}};}
\DoxyCodeLine{202   }
\DoxyCodeLine{203   arma\_debug\_check( (dim > 1), \textcolor{stringliteral}{"{}hist(): parameter 'dim' must be 0 or 1"{}} );}
\DoxyCodeLine{204   }
\DoxyCodeLine{205   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} UA(expr.\mbox{\hyperlink{classmtGlue_a77131a39c19f01beaeaee66908385315}{A}});}
\DoxyCodeLine{206   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T2>}} UB(expr.\mbox{\hyperlink{classmtGlue_a98973407d37b2496bab7af7032233f93}{B}});}
\DoxyCodeLine{207   }
\DoxyCodeLine{208   \textcolor{keywordflow}{if}(UA.is\_alias(out) || UB.is\_alias(out))}
\DoxyCodeLine{209     \{}
\DoxyCodeLine{210     \mbox{\hyperlink{classMat}{Mat<uword>}} tmp;}
\DoxyCodeLine{211     }
\DoxyCodeLine{212     glue\_hist::apply\_noalias(tmp, UA.M, UB.M, dim);}
\DoxyCodeLine{213     }
\DoxyCodeLine{214     out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(tmp);}
\DoxyCodeLine{215     \}}
\DoxyCodeLine{216   \textcolor{keywordflow}{else}}
\DoxyCodeLine{217     \{}
\DoxyCodeLine{218     glue\_hist::apply\_noalias(out, UA.M, UB.M, dim);}
\DoxyCodeLine{219     \}}
\DoxyCodeLine{220   \}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222 }
\DoxyCodeLine{223 }
\DoxyCodeLine{224 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{225 \textcolor{keyword}{inline}}
\DoxyCodeLine{226 \textcolor{keywordtype}{void}}
\DoxyCodeLine{227 glue\_hist\_default::apply(\mbox{\hyperlink{classMat}{Mat<uword>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classmtGlue}{mtGlue<uword,T1,T2,glue\_hist\_default>}}\& expr)}
\DoxyCodeLine{228   \{}
\DoxyCodeLine{229   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{230   }
\DoxyCodeLine{231   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} UA(expr.\mbox{\hyperlink{classmtGlue_a77131a39c19f01beaeaee66908385315}{A}});}
\DoxyCodeLine{232   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T2>}} UB(expr.\mbox{\hyperlink{classmtGlue_a98973407d37b2496bab7af7032233f93}{B}});}
\DoxyCodeLine{233   }
\DoxyCodeLine{234   \textcolor{keyword}{const} uword dim = (T1::is\_xvec) ? uword(UA.M.is\_rowvec() ? 1 : 0) : uword((T1::is\_row) ? 1 : 0);}
\DoxyCodeLine{235   }
\DoxyCodeLine{236   \textcolor{keywordflow}{if}(UA.is\_alias(out) || UB.is\_alias(out))}
\DoxyCodeLine{237     \{}
\DoxyCodeLine{238     \mbox{\hyperlink{classMat}{Mat<uword>}} tmp;}
\DoxyCodeLine{239     }
\DoxyCodeLine{240     glue\_hist::apply\_noalias(tmp, UA.M, UB.M, dim);}
\DoxyCodeLine{241     }
\DoxyCodeLine{242     out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(tmp);}
\DoxyCodeLine{243     \}}
\DoxyCodeLine{244   \textcolor{keywordflow}{else}}
\DoxyCodeLine{245     \{}
\DoxyCodeLine{246     glue\_hist::apply\_noalias(out, UA.M, UB.M, dim);}
\DoxyCodeLine{247     \}}
\DoxyCodeLine{248   \}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250 }

\end{DoxyCode}
