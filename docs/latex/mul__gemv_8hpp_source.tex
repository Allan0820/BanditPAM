\hypertarget{mul__gemv_8hpp_source}{}\doxysection{mul\+\_\+gemv.\+hpp}
\label{mul__gemv_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/mul\_gemv.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/mul\_gemv.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{23 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq}}}
\DoxyCodeLine{25   \{}
\DoxyCodeLine{26   \textcolor{keyword}{public}:}
\DoxyCodeLine{27   }
\DoxyCodeLine{28   }
\DoxyCodeLine{29   \textcolor{keyword}{template}<const uword row, const uword col>}
\DoxyCodeLine{30   \textcolor{keyword}{struct }\mbox{\hyperlink{structgemv__emul__tinysq_1_1pos}{pos}}}
\DoxyCodeLine{31     \{}
\DoxyCodeLine{32     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} uword n2 = (do\_trans\_A == \textcolor{keyword}{false}) ? (row + col*2) : (col + row*2);}
\DoxyCodeLine{33     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} uword n3 = (do\_trans\_A == \textcolor{keyword}{false}) ? (row + col*3) : (col + row*3);}
\DoxyCodeLine{34     \textcolor{keyword}{static} \textcolor{keyword}{constexpr} uword n4 = (do\_trans\_A == \textcolor{keyword}{false}) ? (row + col*4) : (col + row*4);}
\DoxyCodeLine{35     \};}
\DoxyCodeLine{36   }
\DoxyCodeLine{37   }
\DoxyCodeLine{38   }
\DoxyCodeLine{39   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, const uword i>}
\DoxyCodeLine{40   arma\_inline}
\DoxyCodeLine{41   \textcolor{keyword}{static}}
\DoxyCodeLine{42   \textcolor{keywordtype}{void}}
\DoxyCodeLine{43   assign(eT* y, \textcolor{keyword}{const} eT acc, \textcolor{keyword}{const} eT alpha, \textcolor{keyword}{const} eT beta)}
\DoxyCodeLine{44     \{}
\DoxyCodeLine{45     \textcolor{keywordflow}{if}(use\_beta == \textcolor{keyword}{false})}
\DoxyCodeLine{46       \{}
\DoxyCodeLine{47       y[i] = (use\_alpha == \textcolor{keyword}{false}) ? acc : alpha*acc;}
\DoxyCodeLine{48       \}}
\DoxyCodeLine{49     \textcolor{keywordflow}{else}}
\DoxyCodeLine{50       \{}
\DoxyCodeLine{51       \textcolor{keyword}{const} eT tmp = y[i];}
\DoxyCodeLine{52       }
\DoxyCodeLine{53       y[i] = beta*tmp + ( (use\_alpha == \textcolor{keyword}{false}) ? acc : alpha*acc );}
\DoxyCodeLine{54       \}}
\DoxyCodeLine{55     \}}
\DoxyCodeLine{56   }
\DoxyCodeLine{57   }
\DoxyCodeLine{58 }
\DoxyCodeLine{59   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{60   arma\_cold}
\DoxyCodeLine{61   \textcolor{keyword}{inline}}
\DoxyCodeLine{62   \textcolor{keyword}{static}}
\DoxyCodeLine{63   \textcolor{keywordtype}{void}}
\DoxyCodeLine{64   apply( eT* y, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{65     \{}
\DoxyCodeLine{66     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{67     }
\DoxyCodeLine{68     \textcolor{keyword}{const} eT*  Am = \mbox{\hyperlink{structA}{A}}.memptr();}
\DoxyCodeLine{69     }
\DoxyCodeLine{70     \textcolor{keywordflow}{switch}(\mbox{\hyperlink{structA}{A}}.n\_rows)}
\DoxyCodeLine{71       \{}
\DoxyCodeLine{72       \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{73         \{}
\DoxyCodeLine{74         \textcolor{keyword}{const} eT acc = Am[0] * x[0];}
\DoxyCodeLine{75         }
\DoxyCodeLine{76         assign<eT, 0>(y, acc, alpha, beta);}
\DoxyCodeLine{77         \}}
\DoxyCodeLine{78         \textcolor{keywordflow}{break};}
\DoxyCodeLine{79       }
\DoxyCodeLine{80       }
\DoxyCodeLine{81       \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{82         \{}
\DoxyCodeLine{83         \textcolor{keyword}{const} eT x0 = x[0];}
\DoxyCodeLine{84         \textcolor{keyword}{const} eT x1 = x[1];}
\DoxyCodeLine{85         }
\DoxyCodeLine{86         \textcolor{keyword}{const} eT acc0 = Am[pos<0,0>::n2]*x0 + Am[pos<0,1>::n2]*x1;}
\DoxyCodeLine{87         \textcolor{keyword}{const} eT acc1 = Am[pos<1,0>::n2]*x0 + Am[pos<1,1>::n2]*x1;}
\DoxyCodeLine{88         }
\DoxyCodeLine{89         assign<eT, 0>(y, acc0, alpha, beta);}
\DoxyCodeLine{90         assign<eT, 1>(y, acc1, alpha, beta);}
\DoxyCodeLine{91         \}}
\DoxyCodeLine{92         \textcolor{keywordflow}{break};}
\DoxyCodeLine{93       }
\DoxyCodeLine{94         }
\DoxyCodeLine{95       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{96         \{}
\DoxyCodeLine{97         \textcolor{keyword}{const} eT x0 = x[0];}
\DoxyCodeLine{98         \textcolor{keyword}{const} eT x1 = x[1];}
\DoxyCodeLine{99         \textcolor{keyword}{const} eT x2 = x[2];}
\DoxyCodeLine{100         }
\DoxyCodeLine{101         \textcolor{keyword}{const} eT acc0 = Am[pos<0,0>::n3]*x0 + Am[pos<0,1>::n3]*x1 + Am[pos<0,2>::n3]*x2;}
\DoxyCodeLine{102         \textcolor{keyword}{const} eT acc1 = Am[pos<1,0>::n3]*x0 + Am[pos<1,1>::n3]*x1 + Am[pos<1,2>::n3]*x2;}
\DoxyCodeLine{103         \textcolor{keyword}{const} eT acc2 = Am[pos<2,0>::n3]*x0 + Am[pos<2,1>::n3]*x1 + Am[pos<2,2>::n3]*x2;}
\DoxyCodeLine{104         }
\DoxyCodeLine{105         assign<eT, 0>(y, acc0, alpha, beta);}
\DoxyCodeLine{106         assign<eT, 1>(y, acc1, alpha, beta);}
\DoxyCodeLine{107         assign<eT, 2>(y, acc2, alpha, beta);}
\DoxyCodeLine{108         \}}
\DoxyCodeLine{109         \textcolor{keywordflow}{break};}
\DoxyCodeLine{110       }
\DoxyCodeLine{111       }
\DoxyCodeLine{112       \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{113         \{}
\DoxyCodeLine{114         \textcolor{keyword}{const} eT x0 = x[0];}
\DoxyCodeLine{115         \textcolor{keyword}{const} eT x1 = x[1];}
\DoxyCodeLine{116         \textcolor{keyword}{const} eT x2 = x[2];}
\DoxyCodeLine{117         \textcolor{keyword}{const} eT x3 = x[3];}
\DoxyCodeLine{118         }
\DoxyCodeLine{119         \textcolor{keyword}{const} eT acc0 = Am[pos<0,0>::n4]*x0 + Am[pos<0,1>::n4]*x1 + Am[pos<0,2>::n4]*x2 + Am[pos<0,3>::n4]*x3;}
\DoxyCodeLine{120         \textcolor{keyword}{const} eT acc1 = Am[pos<1,0>::n4]*x0 + Am[pos<1,1>::n4]*x1 + Am[pos<1,2>::n4]*x2 + Am[pos<1,3>::n4]*x3;}
\DoxyCodeLine{121         \textcolor{keyword}{const} eT acc2 = Am[pos<2,0>::n4]*x0 + Am[pos<2,1>::n4]*x1 + Am[pos<2,2>::n4]*x2 + Am[pos<2,3>::n4]*x3;}
\DoxyCodeLine{122         \textcolor{keyword}{const} eT acc3 = Am[pos<3,0>::n4]*x0 + Am[pos<3,1>::n4]*x1 + Am[pos<3,2>::n4]*x2 + Am[pos<3,3>::n4]*x3;}
\DoxyCodeLine{123         }
\DoxyCodeLine{124         assign<eT, 0>(y, acc0, alpha, beta);}
\DoxyCodeLine{125         assign<eT, 1>(y, acc1, alpha, beta);}
\DoxyCodeLine{126         assign<eT, 2>(y, acc2, alpha, beta);}
\DoxyCodeLine{127         assign<eT, 3>(y, acc3, alpha, beta);}
\DoxyCodeLine{128         \}}
\DoxyCodeLine{129         \textcolor{keywordflow}{break};}
\DoxyCodeLine{130       }
\DoxyCodeLine{131       }
\DoxyCodeLine{132       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{133         ;}
\DoxyCodeLine{134       \}}
\DoxyCodeLine{135     \}}
\DoxyCodeLine{136     }
\DoxyCodeLine{137   \};}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 }
\DoxyCodeLine{140 }
\DoxyCodeLine{141 \textcolor{keyword}{class }\mbox{\hyperlink{classgemv__emul__helper}{gemv\_emul\_helper}}}
\DoxyCodeLine{142   \{}
\DoxyCodeLine{143   \textcolor{keyword}{public}:}
\DoxyCodeLine{144   }
\DoxyCodeLine{145   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{146   arma\_hot}
\DoxyCodeLine{147   \textcolor{keyword}{inline}}
\DoxyCodeLine{148   \textcolor{keyword}{static}}
\DoxyCodeLine{149   \textcolor{keyword}{typename} arma\_not\_cx<eT>::result}
\DoxyCodeLine{150   dot\_row\_col( \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} uword row, \textcolor{keyword}{const} uword N )}
\DoxyCodeLine{151     \{}
\DoxyCodeLine{152     eT acc1 = eT(0);}
\DoxyCodeLine{153     eT acc2 = eT(0);}
\DoxyCodeLine{154     }
\DoxyCodeLine{155     uword i,j;}
\DoxyCodeLine{156     \textcolor{keywordflow}{for}(i=0, j=1; j < N; i+=2, j+=2)}
\DoxyCodeLine{157       \{}
\DoxyCodeLine{158       \textcolor{keyword}{const} eT xi = x[i];}
\DoxyCodeLine{159       \textcolor{keyword}{const} eT xj = x[j];}
\DoxyCodeLine{160       }
\DoxyCodeLine{161       acc1 += \mbox{\hyperlink{structA}{A}}.at(row,i) * xi;}
\DoxyCodeLine{162       acc2 += \mbox{\hyperlink{structA}{A}}.at(row,j) * xj;}
\DoxyCodeLine{163       \}}
\DoxyCodeLine{164     }
\DoxyCodeLine{165     \textcolor{keywordflow}{if}(i < N)}
\DoxyCodeLine{166       \{}
\DoxyCodeLine{167       acc1 += \mbox{\hyperlink{structA}{A}}.at(row,i) * x[i];}
\DoxyCodeLine{168       \}}
\DoxyCodeLine{169     }
\DoxyCodeLine{170     \textcolor{keywordflow}{return} (acc1 + acc2);}
\DoxyCodeLine{171     \}}
\DoxyCodeLine{172   }
\DoxyCodeLine{173   }
\DoxyCodeLine{174   }
\DoxyCodeLine{175   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{176   arma\_hot}
\DoxyCodeLine{177   \textcolor{keyword}{inline}}
\DoxyCodeLine{178   \textcolor{keyword}{static}}
\DoxyCodeLine{179   \textcolor{keyword}{typename} \mbox{\hyperlink{structarma__cx__only}{arma\_cx\_only<eT>::result}}}
\DoxyCodeLine{180   dot\_row\_col( \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} uword row, \textcolor{keyword}{const} uword N )}
\DoxyCodeLine{181     \{}
\DoxyCodeLine{182     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} get\_pod\_type<eT>::result T;}
\DoxyCodeLine{183     }
\DoxyCodeLine{184     T val\_real = T(0);}
\DoxyCodeLine{185     T val\_imag = T(0);}
\DoxyCodeLine{186     }
\DoxyCodeLine{187     \textcolor{keywordflow}{for}(uword i=0; i<N; ++i)}
\DoxyCodeLine{188       \{}
\DoxyCodeLine{189       \textcolor{keyword}{const} std::complex<T>\& Ai = \mbox{\hyperlink{structA}{A}}.at(row,i);}
\DoxyCodeLine{190       \textcolor{keyword}{const} std::complex<T>\& xi = x[i];}
\DoxyCodeLine{191       }
\DoxyCodeLine{192       \textcolor{keyword}{const} T a = Ai.real();}
\DoxyCodeLine{193       \textcolor{keyword}{const} T b = Ai.imag();}
\DoxyCodeLine{194       }
\DoxyCodeLine{195       \textcolor{keyword}{const} T c = xi.real();}
\DoxyCodeLine{196       \textcolor{keyword}{const} T d = xi.imag();}
\DoxyCodeLine{197       }
\DoxyCodeLine{198       val\_real += (a*c) -\/ (b*d);}
\DoxyCodeLine{199       val\_imag += (a*d) + (b*c);}
\DoxyCodeLine{200       \}}
\DoxyCodeLine{201     }
\DoxyCodeLine{202     \textcolor{keywordflow}{return} std::complex<T>(val\_real, val\_imag);}
\DoxyCodeLine{203     \}}
\DoxyCodeLine{204   }
\DoxyCodeLine{205   \};}
\DoxyCodeLine{206 }
\DoxyCodeLine{207 }
\DoxyCodeLine{208 }
\DoxyCodeLine{212 }
\DoxyCodeLine{213 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{214 \textcolor{keyword}{class }\mbox{\hyperlink{classgemv__emul}{gemv\_emul}}}
\DoxyCodeLine{215   \{}
\DoxyCodeLine{216   \textcolor{keyword}{public}:}
\DoxyCodeLine{217   }
\DoxyCodeLine{218   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{219   arma\_hot}
\DoxyCodeLine{220   \textcolor{keyword}{inline}}
\DoxyCodeLine{221   \textcolor{keyword}{static}}
\DoxyCodeLine{222   \textcolor{keywordtype}{void}}
\DoxyCodeLine{223   apply( eT* y, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{224     \{}
\DoxyCodeLine{225     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{226     }
\DoxyCodeLine{227     \textcolor{keyword}{const} uword A\_n\_rows = \mbox{\hyperlink{structA}{A}}.n\_rows;}
\DoxyCodeLine{228     \textcolor{keyword}{const} uword A\_n\_cols = \mbox{\hyperlink{structA}{A}}.n\_cols;}
\DoxyCodeLine{229     }
\DoxyCodeLine{230     \textcolor{keywordflow}{if}(do\_trans\_A == \textcolor{keyword}{false})}
\DoxyCodeLine{231       \{}
\DoxyCodeLine{232       \textcolor{keywordflow}{if}(A\_n\_rows == 1)}
\DoxyCodeLine{233         \{}
\DoxyCodeLine{234         \textcolor{keyword}{const} eT acc = \mbox{\hyperlink{group__op__dot_ga7af686a7089ac5d85b44405385578283}{op\_dot::direct\_dot\_arma}}(A\_n\_cols, \mbox{\hyperlink{structA}{A}}.memptr(), x);}
\DoxyCodeLine{235         }
\DoxyCodeLine{236              \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[0] =       acc;             \}}
\DoxyCodeLine{237         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[0] = alpha*acc;             \}}
\DoxyCodeLine{238         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[0] =       acc + beta*y[0]; \}}
\DoxyCodeLine{239         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[0] = alpha*acc + beta*y[0]; \}}
\DoxyCodeLine{240         \}}
\DoxyCodeLine{241       \textcolor{keywordflow}{else}}
\DoxyCodeLine{242       \textcolor{keywordflow}{for}(uword row=0; row < A\_n\_rows; ++row)}
\DoxyCodeLine{243         \{}
\DoxyCodeLine{244         \textcolor{keyword}{const} eT acc = gemv\_emul\_helper::dot\_row\_col(\mbox{\hyperlink{structA}{A}}, x, row, A\_n\_cols);}
\DoxyCodeLine{245         }
\DoxyCodeLine{246              \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[row] =       acc;               \}}
\DoxyCodeLine{247         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[row] = alpha*acc;               \}}
\DoxyCodeLine{248         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[row] =       acc + beta*y[row]; \}}
\DoxyCodeLine{249         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[row] = alpha*acc + beta*y[row]; \}}
\DoxyCodeLine{250         \}}
\DoxyCodeLine{251       \}}
\DoxyCodeLine{252     \textcolor{keywordflow}{else}}
\DoxyCodeLine{253     \textcolor{keywordflow}{if}(do\_trans\_A == \textcolor{keyword}{true})}
\DoxyCodeLine{254       \{}
\DoxyCodeLine{255       \textcolor{keywordflow}{if}(\mbox{\hyperlink{structis__cx}{is\_cx<eT>::no}})}
\DoxyCodeLine{256         \{}
\DoxyCodeLine{257         \textcolor{keywordflow}{for}(uword col=0; col < A\_n\_cols; ++col)}
\DoxyCodeLine{258           \{}
\DoxyCodeLine{259           \textcolor{comment}{// col is interpreted as row when storing the results in 'y'}}
\DoxyCodeLine{260           }
\DoxyCodeLine{261           }
\DoxyCodeLine{262           \textcolor{comment}{// const eT* A\_coldata = A.colptr(col);}}
\DoxyCodeLine{263           \textcolor{comment}{// }}
\DoxyCodeLine{264           \textcolor{comment}{// eT acc = eT(0);}}
\DoxyCodeLine{265           \textcolor{comment}{// for(uword row=0; row < A\_n\_rows; ++row)}}
\DoxyCodeLine{266           \textcolor{comment}{//   \{}}
\DoxyCodeLine{267           \textcolor{comment}{//   acc += A\_coldata[row] * x[row];}}
\DoxyCodeLine{268           \textcolor{comment}{//   \}}}
\DoxyCodeLine{269           }
\DoxyCodeLine{270           \textcolor{keyword}{const} eT acc = \mbox{\hyperlink{group__op__dot_ga7af686a7089ac5d85b44405385578283}{op\_dot::direct\_dot\_arma}}(A\_n\_rows, \mbox{\hyperlink{structA}{A}}.colptr(col), x);}
\DoxyCodeLine{271           }
\DoxyCodeLine{272                \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[col] =       acc;               \}}
\DoxyCodeLine{273           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ y[col] = alpha*acc;               \}}
\DoxyCodeLine{274           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[col] =       acc + beta*y[col]; \}}
\DoxyCodeLine{275           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ y[col] = alpha*acc + beta*y[col]; \}}
\DoxyCodeLine{276           \}}
\DoxyCodeLine{277         \}}
\DoxyCodeLine{278       \textcolor{keywordflow}{else}}
\DoxyCodeLine{279         \{}
\DoxyCodeLine{280         \mbox{\hyperlink{classMat}{Mat<eT>}} AA;}
\DoxyCodeLine{281         }
\DoxyCodeLine{282         op\_htrans::apply\_mat\_noalias(AA, \mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{283         }
\DoxyCodeLine{284         \mbox{\hyperlink{classgemv__emul}{gemv\_emul<false, use\_alpha, use\_beta>::apply}}(y, AA, x, alpha, beta);}
\DoxyCodeLine{285         \}}
\DoxyCodeLine{286       \}}
\DoxyCodeLine{287     \}}
\DoxyCodeLine{288   }
\DoxyCodeLine{289   \};}
\DoxyCodeLine{290 }
\DoxyCodeLine{291 }
\DoxyCodeLine{292 }
\DoxyCodeLine{296 }
\DoxyCodeLine{297 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{298 \textcolor{keyword}{class }\mbox{\hyperlink{classgemv}{gemv}}}
\DoxyCodeLine{299   \{}
\DoxyCodeLine{300   \textcolor{keyword}{public}:}
\DoxyCodeLine{301   }
\DoxyCodeLine{302   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{303   \textcolor{keyword}{inline}}
\DoxyCodeLine{304   \textcolor{keyword}{static}}
\DoxyCodeLine{305   \textcolor{keywordtype}{void}}
\DoxyCodeLine{306   apply\_blas\_type( eT* y, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{307     \{}
\DoxyCodeLine{308     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{309     }
\DoxyCodeLine{310     \textcolor{keywordflow}{if}( (\mbox{\hyperlink{structA}{A}}.n\_rows <= 4) \&\& (\mbox{\hyperlink{structA}{A}}.n\_rows == \mbox{\hyperlink{structA}{A}}.n\_cols) \&\& (\mbox{\hyperlink{structis__cx}{is\_cx<eT>::no}}) )}
\DoxyCodeLine{311       \{}
\DoxyCodeLine{312       \mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}(y, \mbox{\hyperlink{structA}{A}}, x, alpha, beta);}
\DoxyCodeLine{313       \}}
\DoxyCodeLine{314     \textcolor{keywordflow}{else}}
\DoxyCodeLine{315       \{}
\DoxyCodeLine{316 \textcolor{preprocessor}{      \#if defined(ARMA\_USE\_ATLAS)}}
\DoxyCodeLine{317         \{}
\DoxyCodeLine{318         arma\_debug\_assert\_atlas\_size(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{319         }
\DoxyCodeLine{320         \textcolor{keywordflow}{if}(\mbox{\hyperlink{structis__cx}{is\_cx<eT>::no}})}
\DoxyCodeLine{321           \{}
\DoxyCodeLine{322           \textcolor{comment}{// use gemm() instead of gemv() to work around a speed issue in Atlas 3.8.4}}
\DoxyCodeLine{323           }
\DoxyCodeLine{324           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}atlas::cblas\_gemm()"{}});}
\DoxyCodeLine{325           }
\DoxyCodeLine{326           atlas::cblas\_gemm<eT>}
\DoxyCodeLine{327             (}
\DoxyCodeLine{328             atlas::CblasColMajor,}
\DoxyCodeLine{329             (do\_trans\_A) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? CblasConjTrans : atlas::CblasTrans ) : atlas::CblasNoTrans,}
\DoxyCodeLine{330             atlas::CblasNoTrans,}
\DoxyCodeLine{331             (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_cols : \mbox{\hyperlink{structA}{A}}.n\_rows,}
\DoxyCodeLine{332             1,}
\DoxyCodeLine{333             (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_rows : \mbox{\hyperlink{structA}{A}}.n\_cols,}
\DoxyCodeLine{334             (use\_alpha) ? alpha : eT(1),}
\DoxyCodeLine{335             \mbox{\hyperlink{structA}{A}}.mem,}
\DoxyCodeLine{336             \mbox{\hyperlink{structA}{A}}.n\_rows,}
\DoxyCodeLine{337             x,}
\DoxyCodeLine{338             (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_rows : \mbox{\hyperlink{structA}{A}}.n\_cols,}
\DoxyCodeLine{339             (use\_beta) ? beta : eT(0),}
\DoxyCodeLine{340             y,}
\DoxyCodeLine{341             (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_cols : \mbox{\hyperlink{structA}{A}}.n\_rows}
\DoxyCodeLine{342             );}
\DoxyCodeLine{343           \}}
\DoxyCodeLine{344         \textcolor{keywordflow}{else}}
\DoxyCodeLine{345           \{}
\DoxyCodeLine{346           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}atlas::cblas\_gemv()"{}});}
\DoxyCodeLine{347           }
\DoxyCodeLine{348           atlas::cblas\_gemv<eT>}
\DoxyCodeLine{349             (}
\DoxyCodeLine{350             atlas::CblasColMajor,}
\DoxyCodeLine{351             (do\_trans\_A) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? CblasConjTrans : atlas::CblasTrans ) : atlas::CblasNoTrans,}
\DoxyCodeLine{352             \mbox{\hyperlink{structA}{A}}.n\_rows,}
\DoxyCodeLine{353             \mbox{\hyperlink{structA}{A}}.n\_cols,}
\DoxyCodeLine{354             (use\_alpha) ? alpha : eT(1),}
\DoxyCodeLine{355             \mbox{\hyperlink{structA}{A}}.mem,}
\DoxyCodeLine{356             \mbox{\hyperlink{structA}{A}}.n\_rows,}
\DoxyCodeLine{357             x,}
\DoxyCodeLine{358             1,}
\DoxyCodeLine{359             (use\_beta) ? beta : eT(0),}
\DoxyCodeLine{360             y,}
\DoxyCodeLine{361             1}
\DoxyCodeLine{362             );}
\DoxyCodeLine{363           \}}
\DoxyCodeLine{364         \}}
\DoxyCodeLine{365 \textcolor{preprocessor}{      \#elif defined(ARMA\_USE\_BLAS)}}
\DoxyCodeLine{366         \{}
\DoxyCodeLine{367         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}blas::gemv()"{}});}
\DoxyCodeLine{368         }
\DoxyCodeLine{369         arma\_debug\_assert\_blas\_size(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{370         }
\DoxyCodeLine{371         \textcolor{keyword}{const} \textcolor{keywordtype}{char}      trans\_A     = (do\_trans\_A) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? \textcolor{charliteral}{'C'} : \textcolor{charliteral}{'T'} ) : \textcolor{charliteral}{'N'};}
\DoxyCodeLine{372         \textcolor{keyword}{const} blas\_int  m           = blas\_int(\mbox{\hyperlink{structA}{A}}.n\_rows);}
\DoxyCodeLine{373         \textcolor{keyword}{const} blas\_int  n           = blas\_int(\mbox{\hyperlink{structA}{A}}.n\_cols);}
\DoxyCodeLine{374         \textcolor{keyword}{const} eT        local\_alpha = (use\_alpha) ? alpha : eT(1);}
\DoxyCodeLine{375         \textcolor{comment}{//const blas\_int  lda         = A.n\_rows;}}
\DoxyCodeLine{376         \textcolor{keyword}{const} blas\_int  inc         = blas\_int(1);}
\DoxyCodeLine{377         \textcolor{keyword}{const} eT        local\_beta  = (use\_beta) ? beta : eT(0);}
\DoxyCodeLine{378         }
\DoxyCodeLine{379         arma\_extra\_debug\_print( \mbox{\hyperlink{classarma__str_1_1format}{arma\_str::format}}(\textcolor{stringliteral}{"{}blas::gemv(): trans\_A = \%c"{}}) \% trans\_A );}
\DoxyCodeLine{380         }
\DoxyCodeLine{381         blas::gemv<eT>}
\DoxyCodeLine{382           (}
\DoxyCodeLine{383           \&trans\_A,}
\DoxyCodeLine{384           \&m,}
\DoxyCodeLine{385           \&n,}
\DoxyCodeLine{386           \&local\_alpha,}
\DoxyCodeLine{387           \mbox{\hyperlink{structA}{A}}.mem,}
\DoxyCodeLine{388           \&m,  \textcolor{comment}{// lda}}
\DoxyCodeLine{389           x,}
\DoxyCodeLine{390           \&inc,}
\DoxyCodeLine{391           \&local\_beta,}
\DoxyCodeLine{392           y,}
\DoxyCodeLine{393           \&inc}
\DoxyCodeLine{394           );}
\DoxyCodeLine{395         \}}
\DoxyCodeLine{396 \textcolor{preprocessor}{      \#else}}
\DoxyCodeLine{397         \{}
\DoxyCodeLine{398         \mbox{\hyperlink{classgemv__emul}{gemv\_emul<do\_trans\_A, use\_alpha, use\_beta>::apply}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{399         \}}
\DoxyCodeLine{400 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{401       \}}
\DoxyCodeLine{402     }
\DoxyCodeLine{403     \}}
\DoxyCodeLine{404   }
\DoxyCodeLine{405   }
\DoxyCodeLine{406   }
\DoxyCodeLine{407   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA>}
\DoxyCodeLine{408   arma\_inline}
\DoxyCodeLine{409   \textcolor{keyword}{static}}
\DoxyCodeLine{410   \textcolor{keywordtype}{void}}
\DoxyCodeLine{411   apply( eT* y, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} eT* x, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{412     \{}
\DoxyCodeLine{413     \mbox{\hyperlink{classgemv__emul}{gemv\_emul<do\_trans\_A, use\_alpha, use\_beta>::apply}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{414     \}}
\DoxyCodeLine{415   }
\DoxyCodeLine{416   }
\DoxyCodeLine{417   }
\DoxyCodeLine{418   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA>}
\DoxyCodeLine{419   arma\_inline}
\DoxyCodeLine{420   \textcolor{keyword}{static}}
\DoxyCodeLine{421   \textcolor{keywordtype}{void}}
\DoxyCodeLine{422   apply}
\DoxyCodeLine{423     (}
\DoxyCodeLine{424           \textcolor{keywordtype}{float}* y,}
\DoxyCodeLine{425     \textcolor{keyword}{const} TA\&    \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{426     \textcolor{keyword}{const} \textcolor{keywordtype}{float}* x,}
\DoxyCodeLine{427     \textcolor{keyword}{const} \textcolor{keywordtype}{float}  alpha = \textcolor{keywordtype}{float}(1),}
\DoxyCodeLine{428     \textcolor{keyword}{const} \textcolor{keywordtype}{float}  beta  = \textcolor{keywordtype}{float}(0)}
\DoxyCodeLine{429     )}
\DoxyCodeLine{430     \{}
\DoxyCodeLine{431     \mbox{\hyperlink{classgemv}{gemv<do\_trans\_A, use\_alpha, use\_beta>::apply\_blas\_type}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{432     \}}
\DoxyCodeLine{433   }
\DoxyCodeLine{434   }
\DoxyCodeLine{435   }
\DoxyCodeLine{436   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA>}
\DoxyCodeLine{437   arma\_inline}
\DoxyCodeLine{438   \textcolor{keyword}{static}}
\DoxyCodeLine{439   \textcolor{keywordtype}{void}}
\DoxyCodeLine{440   apply}
\DoxyCodeLine{441     (}
\DoxyCodeLine{442           \textcolor{keywordtype}{double}* y,}
\DoxyCodeLine{443     \textcolor{keyword}{const} TA\&     \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{444     \textcolor{keyword}{const} \textcolor{keywordtype}{double}* x,}
\DoxyCodeLine{445     \textcolor{keyword}{const} \textcolor{keywordtype}{double}  alpha = \textcolor{keywordtype}{double}(1),}
\DoxyCodeLine{446     \textcolor{keyword}{const} \textcolor{keywordtype}{double}  beta  = \textcolor{keywordtype}{double}(0)}
\DoxyCodeLine{447     )}
\DoxyCodeLine{448     \{}
\DoxyCodeLine{449     \mbox{\hyperlink{classgemv}{gemv<do\_trans\_A, use\_alpha, use\_beta>::apply\_blas\_type}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{450     \}}
\DoxyCodeLine{451   }
\DoxyCodeLine{452   }
\DoxyCodeLine{453   }
\DoxyCodeLine{454   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA>}
\DoxyCodeLine{455   arma\_inline}
\DoxyCodeLine{456   \textcolor{keyword}{static}}
\DoxyCodeLine{457   \textcolor{keywordtype}{void}}
\DoxyCodeLine{458   apply}
\DoxyCodeLine{459     (}
\DoxyCodeLine{460           std::complex<float>* y,}
\DoxyCodeLine{461     \textcolor{keyword}{const} TA\&                  \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{462     \textcolor{keyword}{const} std::complex<float>* x,}
\DoxyCodeLine{463     \textcolor{keyword}{const} std::complex<float>  alpha = std::complex<float>(1),}
\DoxyCodeLine{464     \textcolor{keyword}{const} std::complex<float>  beta  = std::complex<float>(0)}
\DoxyCodeLine{465     )}
\DoxyCodeLine{466     \{}
\DoxyCodeLine{467     \mbox{\hyperlink{classgemv}{gemv<do\_trans\_A, use\_alpha, use\_beta>::apply\_blas\_type}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{468     \}}
\DoxyCodeLine{469 }
\DoxyCodeLine{470 }
\DoxyCodeLine{471   }
\DoxyCodeLine{472   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA>}
\DoxyCodeLine{473   arma\_inline}
\DoxyCodeLine{474   \textcolor{keyword}{static}}
\DoxyCodeLine{475   \textcolor{keywordtype}{void}}
\DoxyCodeLine{476   apply}
\DoxyCodeLine{477     (}
\DoxyCodeLine{478           std::complex<double>* y,}
\DoxyCodeLine{479     \textcolor{keyword}{const} TA\&                   \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{480     \textcolor{keyword}{const} std::complex<double>* x,}
\DoxyCodeLine{481     \textcolor{keyword}{const} std::complex<double>  alpha = std::complex<double>(1),}
\DoxyCodeLine{482     \textcolor{keyword}{const} std::complex<double>  beta  = std::complex<double>(0)}
\DoxyCodeLine{483     )}
\DoxyCodeLine{484     \{}
\DoxyCodeLine{485     \mbox{\hyperlink{classgemv}{gemv<do\_trans\_A, use\_alpha, use\_beta>::apply\_blas\_type}}(y,\mbox{\hyperlink{structA}{A}},x,alpha,beta);}
\DoxyCodeLine{486     \}}
\DoxyCodeLine{487 }
\DoxyCodeLine{488 }
\DoxyCodeLine{489   }
\DoxyCodeLine{490   \};}
\DoxyCodeLine{491 }
\DoxyCodeLine{492 }

\end{DoxyCode}
