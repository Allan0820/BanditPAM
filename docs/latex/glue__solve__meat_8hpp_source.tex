\hypertarget{glue__solve__meat_8hpp_source}{}\doxysection{glue\+\_\+solve\+\_\+meat.\+hpp}
\label{glue__solve__meat_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/glue\_solve\_meat.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/glue\_solve\_meat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{comment}{//}}
\DoxyCodeLine{23 \textcolor{comment}{// glue\_solve\_gen}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{27 \textcolor{keyword}{inline}}
\DoxyCodeLine{28 \textcolor{keywordtype}{void}}
\DoxyCodeLine{29 glue\_solve\_gen::apply(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classGlue}{Glue<T1,T2,glue\_solve\_gen>}}\& X)}
\DoxyCodeLine{30   \{}
\DoxyCodeLine{31   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{32   }
\DoxyCodeLine{33   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = glue\_solve\_gen::apply( out, X.A, X.B, X.aux\_uword );}
\DoxyCodeLine{34   }
\DoxyCodeLine{35   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{36     \{}
\DoxyCodeLine{37     out.soft\_reset();}
\DoxyCodeLine{38     arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}solve(): solution not found"{}});}
\DoxyCodeLine{39     \}}
\DoxyCodeLine{40   \}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 }
\DoxyCodeLine{43 }
\DoxyCodeLine{44 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{45 \textcolor{keyword}{inline}}
\DoxyCodeLine{46 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{47 glue\_solve\_gen::apply(\mbox{\hyperlink{classMat}{Mat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T1>}}\& A\_expr, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T2>}}\& B\_expr, \textcolor{keyword}{const} uword flags)}
\DoxyCodeLine{48   \{}
\DoxyCodeLine{49   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{50   }
\DoxyCodeLine{51   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} get\_pod\_type<eT>::result T;}
\DoxyCodeLine{52   }
\DoxyCodeLine{53   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} fast         = bool(flags \& solve\_opts::flag\_fast        );}
\DoxyCodeLine{54   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} equilibrate  = bool(flags \& solve\_opts::flag\_equilibrate );}
\DoxyCodeLine{55   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_approx    = bool(flags \& solve\_opts::flag\_no\_approx   );}
\DoxyCodeLine{56   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_band      = bool(flags \& solve\_opts::flag\_no\_band     );}
\DoxyCodeLine{57   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_sympd     = bool(flags \& solve\_opts::flag\_no\_sympd    );}
\DoxyCodeLine{58   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} allow\_ugly   = bool(flags \& solve\_opts::flag\_allow\_ugly  );}
\DoxyCodeLine{59   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} likely\_sympd = bool(flags \& solve\_opts::flag\_likely\_sympd);}
\DoxyCodeLine{60   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} refine       = bool(flags \& solve\_opts::flag\_refine      );}
\DoxyCodeLine{61   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_trimat    = bool(flags \& solve\_opts::flag\_no\_trimat   );}
\DoxyCodeLine{62   }
\DoxyCodeLine{63   arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): enabled flags:"{}});}
\DoxyCodeLine{64   }
\DoxyCodeLine{65   \textcolor{keywordflow}{if}(fast        )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}fast"{}});         \}}
\DoxyCodeLine{66   \textcolor{keywordflow}{if}(equilibrate )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}equilibrate"{}});  \}}
\DoxyCodeLine{67   \textcolor{keywordflow}{if}(no\_approx   )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_approx"{}});    \}}
\DoxyCodeLine{68   \textcolor{keywordflow}{if}(no\_band     )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_band"{}});      \}}
\DoxyCodeLine{69   \textcolor{keywordflow}{if}(no\_sympd    )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_sympd"{}});     \}}
\DoxyCodeLine{70   \textcolor{keywordflow}{if}(allow\_ugly  )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}allow\_ugly"{}});   \}}
\DoxyCodeLine{71   \textcolor{keywordflow}{if}(likely\_sympd)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}likely\_sympd"{}}); \}}
\DoxyCodeLine{72   \textcolor{keywordflow}{if}(refine      )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}refine"{}});       \}}
\DoxyCodeLine{73   \textcolor{keywordflow}{if}(no\_trimat   )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_trimat"{}});    \}}
\DoxyCodeLine{74   }
\DoxyCodeLine{75   arma\_debug\_check( (fast     \&\& equilibrate ), \textcolor{stringliteral}{"{}solve(): options 'fast' and 'equilibrate' are mutually exclusive"{}}      );}
\DoxyCodeLine{76   arma\_debug\_check( (fast     \&\& refine      ), \textcolor{stringliteral}{"{}solve(): options 'fast' and 'refine' are mutually exclusive"{}}           );}
\DoxyCodeLine{77   arma\_debug\_check( (no\_sympd \&\& likely\_sympd), \textcolor{stringliteral}{"{}solve(): options 'no\_sympd' and 'likely\_sympd' are mutually exclusive"{}} );}
\DoxyCodeLine{78   }
\DoxyCodeLine{79   T    rcond  = T(0);}
\DoxyCodeLine{80   \textcolor{keywordtype}{bool} status = \textcolor{keyword}{false};}
\DoxyCodeLine{81   }
\DoxyCodeLine{82   \mbox{\hyperlink{classMat}{Mat<eT>}} \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();}
\DoxyCodeLine{83   }
\DoxyCodeLine{84   \textcolor{keywordflow}{if}(\mbox{\hyperlink{structA}{A}}.n\_rows == \mbox{\hyperlink{structA}{A}}.n\_cols)}
\DoxyCodeLine{85     \{}
\DoxyCodeLine{86     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): detected square system"{}});}
\DoxyCodeLine{87     }
\DoxyCodeLine{88     uword KL = 0;}
\DoxyCodeLine{89     uword KU = 0;}
\DoxyCodeLine{90     }
\DoxyCodeLine{91 \textcolor{preprocessor}{    \#if defined(ARMA\_OPTIMISE\_BAND)}}
\DoxyCodeLine{92       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_band  = (no\_band || auxlib::crippled\_lapack(\mbox{\hyperlink{structA}{A}})) ? \textcolor{keyword}{false} : band\_helper::is\_band(KL, KU, \mbox{\hyperlink{structA}{A}}, uword(32));}
\DoxyCodeLine{93 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{94       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_band  = \textcolor{keyword}{false};}
\DoxyCodeLine{95 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{96     }
\DoxyCodeLine{97     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_triu = (no\_trimat || refine || equilibrate || likely\_sympd || is\_band           ) ? \textcolor{keyword}{false} : trimat\_helper::is\_triu(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{98     \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_tril = (no\_trimat || refine || equilibrate || likely\_sympd || is\_band || is\_triu) ? \textcolor{keyword}{false} : trimat\_helper::is\_tril(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{99     }
\DoxyCodeLine{100 \textcolor{preprocessor}{    \#if defined(ARMA\_OPTIMISE\_SYMPD)}}
\DoxyCodeLine{101       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} try\_sympd = (no\_sympd || auxlib::crippled\_lapack(\mbox{\hyperlink{structA}{A}}) || is\_band || is\_triu || is\_tril) ? \textcolor{keyword}{false} : (likely\_sympd ? \textcolor{keyword}{true} : sympd\_helper::guess\_sympd(\mbox{\hyperlink{structA}{A}}));}
\DoxyCodeLine{102 \textcolor{preprocessor}{    \#else}}
\DoxyCodeLine{103       \textcolor{keyword}{const} \textcolor{keywordtype}{bool} try\_sympd = \textcolor{keyword}{false};}
\DoxyCodeLine{104 \textcolor{preprocessor}{    \#endif}}
\DoxyCodeLine{105     }
\DoxyCodeLine{106     \textcolor{keywordflow}{if}(fast)}
\DoxyCodeLine{107       \{}
\DoxyCodeLine{108       \textcolor{comment}{// fast mode: solvers without refinement and without rcond estimate}}
\DoxyCodeLine{109       }
\DoxyCodeLine{110       arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast mode"{}});}
\DoxyCodeLine{111       }
\DoxyCodeLine{112       \textcolor{keywordflow}{if}(is\_band)}
\DoxyCodeLine{113         \{}
\DoxyCodeLine{114         \textcolor{keywordflow}{if}( (KL == 1) \&\& (KU == 1) )}
\DoxyCodeLine{115           \{}
\DoxyCodeLine{116           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + tridiagonal"{}});}
\DoxyCodeLine{117           }
\DoxyCodeLine{118           status = \mbox{\hyperlink{group__auxlib_ga463326aa06a967b1dab4c17bc0a350b5}{auxlib::solve\_tridiag\_fast}}(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());}
\DoxyCodeLine{119           \}}
\DoxyCodeLine{120         \textcolor{keywordflow}{else}}
\DoxyCodeLine{121           \{}
\DoxyCodeLine{122           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + band"{}});}
\DoxyCodeLine{123           }
\DoxyCodeLine{124           status = \mbox{\hyperlink{group__auxlib_gab6113ebff3bb4633d77d574813c981e6}{auxlib::solve\_band\_fast}}(out, \mbox{\hyperlink{structA}{A}}, KL, KU, B\_expr.get\_ref());}
\DoxyCodeLine{125           \}}
\DoxyCodeLine{126         \}}
\DoxyCodeLine{127       \textcolor{keywordflow}{else}}
\DoxyCodeLine{128       \textcolor{keywordflow}{if}(is\_triu || is\_tril)}
\DoxyCodeLine{129         \{}
\DoxyCodeLine{130         \textcolor{keywordflow}{if}(is\_triu)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + upper triangular matrix"{}}); \}}
\DoxyCodeLine{131         \textcolor{keywordflow}{if}(is\_tril)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + lower triangular matrix"{}}); \}}
\DoxyCodeLine{132         }
\DoxyCodeLine{133         \textcolor{keyword}{const} uword layout = (is\_triu) ? uword(0) : uword(1);}
\DoxyCodeLine{134         }
\DoxyCodeLine{135         status = auxlib::solve\_trimat\_fast(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), layout);}
\DoxyCodeLine{136         \}}
\DoxyCodeLine{137       \textcolor{keywordflow}{else}}
\DoxyCodeLine{138       \textcolor{keywordflow}{if}(try\_sympd)}
\DoxyCodeLine{139         \{}
\DoxyCodeLine{140         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + try\_sympd"{}});}
\DoxyCodeLine{141         }
\DoxyCodeLine{142         status = auxlib::solve\_sympd\_fast(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{143         }
\DoxyCodeLine{144         \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{145           \{}
\DoxyCodeLine{146           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): auxlib::solve\_sympd\_fast() failed; retrying"{}});}
\DoxyCodeLine{147           }
\DoxyCodeLine{148           \textcolor{comment}{// auxlib::solve\_sympd\_fast() may have failed because A isn't really sympd}}
\DoxyCodeLine{149           \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();}
\DoxyCodeLine{150           status = \mbox{\hyperlink{group__auxlib_ga530089e89e43155f3bf6e709bbe775dd}{auxlib::solve\_square\_fast}}(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{151           \}}
\DoxyCodeLine{152         \}}
\DoxyCodeLine{153       \textcolor{keywordflow}{else}}
\DoxyCodeLine{154         \{}
\DoxyCodeLine{155         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): fast + dense"{}});}
\DoxyCodeLine{156         }
\DoxyCodeLine{157         status = \mbox{\hyperlink{group__auxlib_ga530089e89e43155f3bf6e709bbe775dd}{auxlib::solve\_square\_fast}}(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{158         \}}
\DoxyCodeLine{159       \}}
\DoxyCodeLine{160     \textcolor{keywordflow}{else}}
\DoxyCodeLine{161     \textcolor{keywordflow}{if}(refine || equilibrate)}
\DoxyCodeLine{162       \{}
\DoxyCodeLine{163       \textcolor{comment}{// refine mode: solvers with refinement and with rcond estimate}}
\DoxyCodeLine{164       }
\DoxyCodeLine{165       arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): refine mode"{}});}
\DoxyCodeLine{166       }
\DoxyCodeLine{167       \textcolor{keywordflow}{if}(is\_band)}
\DoxyCodeLine{168         \{}
\DoxyCodeLine{169         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): refine + band"{}});}
\DoxyCodeLine{170         }
\DoxyCodeLine{171         status = \mbox{\hyperlink{group__auxlib_ga00042cee38300d1df5196cbb8247ab34}{auxlib::solve\_band\_refine}}(out, rcond, \mbox{\hyperlink{structA}{A}}, KL, KU, B\_expr, equilibrate, allow\_ugly);}
\DoxyCodeLine{172         \}}
\DoxyCodeLine{173       \textcolor{keywordflow}{else}}
\DoxyCodeLine{174       \textcolor{keywordflow}{if}(try\_sympd)}
\DoxyCodeLine{175         \{}
\DoxyCodeLine{176         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): refine + try\_sympd"{}});}
\DoxyCodeLine{177         }
\DoxyCodeLine{178         status = \mbox{\hyperlink{group__auxlib_gab44e1fb14a3c2bb6aaedbc3782ce6839}{auxlib::solve\_sympd\_refine}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), equilibrate, allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{179         }
\DoxyCodeLine{180         \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{181           \{}
\DoxyCodeLine{182           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): auxlib::solve\_sympd\_refine() failed; retrying"{}});}
\DoxyCodeLine{183           }
\DoxyCodeLine{184           \textcolor{comment}{// auxlib::solve\_sympd\_refine() may have failed because A isn't really sympd}}
\DoxyCodeLine{185           \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();}
\DoxyCodeLine{186           status = \mbox{\hyperlink{group__auxlib_gab1d24ba6a7f6a7aad1b5bcf4d75bd1bf}{auxlib::solve\_square\_refine}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), equilibrate, allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{187           \}}
\DoxyCodeLine{188         \}}
\DoxyCodeLine{189       \textcolor{keywordflow}{else}}
\DoxyCodeLine{190         \{}
\DoxyCodeLine{191         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): refine + dense"{}});}
\DoxyCodeLine{192         }
\DoxyCodeLine{193         status = \mbox{\hyperlink{group__auxlib_gab1d24ba6a7f6a7aad1b5bcf4d75bd1bf}{auxlib::solve\_square\_refine}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr, equilibrate, allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{194         \}}
\DoxyCodeLine{195       \}}
\DoxyCodeLine{196     \textcolor{keywordflow}{else}}
\DoxyCodeLine{197       \{}
\DoxyCodeLine{198       \textcolor{comment}{// default mode: solvers without refinement but with rcond estimate}}
\DoxyCodeLine{199       }
\DoxyCodeLine{200       arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): default mode"{}});}
\DoxyCodeLine{201       }
\DoxyCodeLine{202       \textcolor{keywordflow}{if}(is\_band)}
\DoxyCodeLine{203         \{}
\DoxyCodeLine{204         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): rcond + band"{}});}
\DoxyCodeLine{205         }
\DoxyCodeLine{206         status = \mbox{\hyperlink{group__auxlib_ga9c2bcb80543054b93973eb61857a3a35}{auxlib::solve\_band\_rcond}}(out, rcond, \mbox{\hyperlink{structA}{A}}, KL, KU, B\_expr.get\_ref(), allow\_ugly);}
\DoxyCodeLine{207         \}}
\DoxyCodeLine{208       \textcolor{keywordflow}{else}}
\DoxyCodeLine{209       \textcolor{keywordflow}{if}(is\_triu || is\_tril)}
\DoxyCodeLine{210         \{}
\DoxyCodeLine{211         \textcolor{keywordflow}{if}(is\_triu)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): rcond + upper triangular matrix"{}}); \}}
\DoxyCodeLine{212         \textcolor{keywordflow}{if}(is\_tril)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): rcond + lower triangular matrix"{}}); \}}
\DoxyCodeLine{213         }
\DoxyCodeLine{214         \textcolor{keyword}{const} uword layout = (is\_triu) ? uword(0) : uword(1);}
\DoxyCodeLine{215         }
\DoxyCodeLine{216         status = auxlib::solve\_trimat\_rcond(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), layout, allow\_ugly);}
\DoxyCodeLine{217         \}}
\DoxyCodeLine{218       \textcolor{keywordflow}{else}}
\DoxyCodeLine{219       \textcolor{keywordflow}{if}(try\_sympd)}
\DoxyCodeLine{220         \{}
\DoxyCodeLine{221         status = \mbox{\hyperlink{group__auxlib_ga62ce89610f71efecc71e6512e32b810a}{auxlib::solve\_sympd\_rcond}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{222         }
\DoxyCodeLine{223         \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{224           \{}
\DoxyCodeLine{225           arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): auxlib::solve\_sympd\_rcond() failed; retrying"{}});}
\DoxyCodeLine{226           }
\DoxyCodeLine{227           \textcolor{comment}{// auxlib::solve\_sympd\_rcond() may have failed because A isn't really sympd}}
\DoxyCodeLine{228           \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();}
\DoxyCodeLine{229           status = \mbox{\hyperlink{group__auxlib_ga16be749fd9b7ac92dd2f437f9e45fdf9}{auxlib::solve\_square\_rcond}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{230           \}}
\DoxyCodeLine{231         \}}
\DoxyCodeLine{232       \textcolor{keywordflow}{else}}
\DoxyCodeLine{233         \{}
\DoxyCodeLine{234         status = \mbox{\hyperlink{group__auxlib_ga16be749fd9b7ac92dd2f437f9e45fdf9}{auxlib::solve\_square\_rcond}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{235         \}}
\DoxyCodeLine{236       \}}
\DoxyCodeLine{237     }
\DoxyCodeLine{238     }
\DoxyCodeLine{239     }
\DoxyCodeLine{240     \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{true}) \&\& (rcond > T(0)) \&\& (rcond < auxlib::epsilon\_lapack(\mbox{\hyperlink{structA}{A}})) )}
\DoxyCodeLine{241       \{}
\DoxyCodeLine{242       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): solution computed, but system is singular to working precision (rcond: "{}}, rcond, \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{243       \}}
\DoxyCodeLine{244     }
\DoxyCodeLine{245     }
\DoxyCodeLine{246     \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{false}) \&\& (no\_approx == \textcolor{keyword}{false}) )}
\DoxyCodeLine{247       \{}
\DoxyCodeLine{248       arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): solving rank deficient system"{}});}
\DoxyCodeLine{249       }
\DoxyCodeLine{250       \textcolor{keywordflow}{if}(rcond > T(0))}
\DoxyCodeLine{251         \{}
\DoxyCodeLine{252         arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular (rcond: "{}}, rcond, \textcolor{stringliteral}{"{}); attempting approx solution"{}});}
\DoxyCodeLine{253         \}}
\DoxyCodeLine{254       \textcolor{keywordflow}{else}}
\DoxyCodeLine{255         \{}
\DoxyCodeLine{256         arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular; attempting approx solution"{}});}
\DoxyCodeLine{257         \}}
\DoxyCodeLine{258       }
\DoxyCodeLine{259       \textcolor{comment}{// TODO: conditionally recreate A: have a separate state flag which indicates whether A was previously overwritten}}
\DoxyCodeLine{260       }
\DoxyCodeLine{261       \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();  \textcolor{comment}{// as A may have been overwritten}}
\DoxyCodeLine{262       }
\DoxyCodeLine{263       status = auxlib::solve\_approx\_svd(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{264       \}}
\DoxyCodeLine{265     \}}
\DoxyCodeLine{266   \textcolor{keywordflow}{else}}
\DoxyCodeLine{267     \{}
\DoxyCodeLine{268     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): detected non-\/square system"{}});}
\DoxyCodeLine{269     }
\DoxyCodeLine{270     \textcolor{keywordflow}{if}(equilibrate)   \{ arma\_debug\_warn\_level(1,  \textcolor{stringliteral}{"{}solve(): option 'equilibrate' ignored for non-\/square matrix"{}}  ); \}}
\DoxyCodeLine{271     \textcolor{keywordflow}{if}(refine)        \{ arma\_debug\_warn\_level(1,  \textcolor{stringliteral}{"{}solve(): option 'refine' ignored for non-\/square matrix"{}}       ); \}}
\DoxyCodeLine{272     \textcolor{keywordflow}{if}(likely\_sympd)  \{ arma\_debug\_warn\_level(1,  \textcolor{stringliteral}{"{}solve(): option 'likely\_sympd' ignored for non-\/square matrix"{}} ); \}}
\DoxyCodeLine{273     }
\DoxyCodeLine{274     \textcolor{keywordflow}{if}(fast)}
\DoxyCodeLine{275       \{}
\DoxyCodeLine{276       status = \mbox{\hyperlink{group__auxlib_ga05e7ac9cd99f556f2fb38f5edfece9e0}{auxlib::solve\_rect\_fast}}(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{277       \}}
\DoxyCodeLine{278     \textcolor{keywordflow}{else}}
\DoxyCodeLine{279       \{}
\DoxyCodeLine{280       status = \mbox{\hyperlink{group__auxlib_ga676eba94edde2d8118168a4a99eec8f3}{auxlib::solve\_rect\_rcond}}(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), allow\_ugly);  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{281       \}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283     \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{true}) \&\& (rcond > T(0)) \&\& (rcond < auxlib::epsilon\_lapack(\mbox{\hyperlink{structA}{A}})) )}
\DoxyCodeLine{284       \{}
\DoxyCodeLine{285       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): solution computed, but system is singular to working precision (rcond: "{}}, rcond, \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{286       \}}
\DoxyCodeLine{287     }
\DoxyCodeLine{288     \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{false}) \&\& (no\_approx == \textcolor{keyword}{false}) )}
\DoxyCodeLine{289       \{}
\DoxyCodeLine{290       arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_gen::apply(): solving rank deficient system"{}});}
\DoxyCodeLine{291       }
\DoxyCodeLine{292       \textcolor{keywordflow}{if}(rcond > T(0))}
\DoxyCodeLine{293         \{}
\DoxyCodeLine{294         arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular (rcond: "{}}, rcond, \textcolor{stringliteral}{"{}); attempting approx solution"{}});}
\DoxyCodeLine{295         \}}
\DoxyCodeLine{296       \textcolor{keywordflow}{else}}
\DoxyCodeLine{297         \{}
\DoxyCodeLine{298         arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular; attempting approx solution"{}});}
\DoxyCodeLine{299         \}}
\DoxyCodeLine{300       }
\DoxyCodeLine{301       \mbox{\hyperlink{structA}{A}} = A\_expr.get\_ref();  \textcolor{comment}{// as A was overwritten}}
\DoxyCodeLine{302       }
\DoxyCodeLine{303       status = auxlib::solve\_approx\_svd(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref());  \textcolor{comment}{// A is overwritten}}
\DoxyCodeLine{304       \}}
\DoxyCodeLine{305     \}}
\DoxyCodeLine{306   }
\DoxyCodeLine{307   }
\DoxyCodeLine{308   \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{309   \}}
\DoxyCodeLine{310 }
\DoxyCodeLine{311 }
\DoxyCodeLine{312 }
\DoxyCodeLine{313 \textcolor{comment}{//}}
\DoxyCodeLine{314 \textcolor{comment}{// glue\_solve\_tri}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316 }
\DoxyCodeLine{317 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{318 \textcolor{keyword}{inline}}
\DoxyCodeLine{319 \textcolor{keywordtype}{void}}
\DoxyCodeLine{320 glue\_solve\_tri\_default::apply(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classGlue}{Glue<T1,T2,glue\_solve\_tri\_default>}}\& X)}
\DoxyCodeLine{321   \{}
\DoxyCodeLine{322   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{323   }
\DoxyCodeLine{324   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = glue\_solve\_tri\_default::apply( out, X.A, X.B, X.aux\_uword );}
\DoxyCodeLine{325   }
\DoxyCodeLine{326   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{327     \{}
\DoxyCodeLine{328     out.soft\_reset();}
\DoxyCodeLine{329     arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}solve(): solution not found"{}});}
\DoxyCodeLine{330     \}}
\DoxyCodeLine{331   \}}
\DoxyCodeLine{332 }
\DoxyCodeLine{333 }
\DoxyCodeLine{334 }
\DoxyCodeLine{335 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{336 \textcolor{keyword}{inline}}
\DoxyCodeLine{337 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{338 glue\_solve\_tri\_default::apply(\mbox{\hyperlink{classMat}{Mat<eT>}}\& actual\_out, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T1>}}\& A\_expr, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T2>}}\& B\_expr, \textcolor{keyword}{const} uword flags)}
\DoxyCodeLine{339   \{}
\DoxyCodeLine{340   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{341   }
\DoxyCodeLine{342   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} get\_pod\_type<eT>::result T;}
\DoxyCodeLine{343   }
\DoxyCodeLine{344   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} triu       = bool(flags \& solve\_opts::flag\_triu);}
\DoxyCodeLine{345   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} tril       = bool(flags \& solve\_opts::flag\_tril);}
\DoxyCodeLine{346   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} allow\_ugly = \textcolor{keyword}{false};}
\DoxyCodeLine{347   }
\DoxyCodeLine{348   arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_tri\_default::apply(): enabled flags:"{}});}
\DoxyCodeLine{349   }
\DoxyCodeLine{350   \textcolor{keywordflow}{if}(triu)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}triu"{}}); \}}
\DoxyCodeLine{351   \textcolor{keywordflow}{if}(tril)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}tril"{}}); \}}
\DoxyCodeLine{352   }
\DoxyCodeLine{353   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} U(A\_expr.get\_ref());}
\DoxyCodeLine{354   \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& \mbox{\hyperlink{structA}{A}}     = U.M;}
\DoxyCodeLine{355   }
\DoxyCodeLine{356   arma\_debug\_check( (\mbox{\hyperlink{structA}{A}}.is\_square() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}solve(): matrix marked as triangular must be square sized"{}} );}
\DoxyCodeLine{357   }
\DoxyCodeLine{358   \textcolor{keyword}{const} uword layout   = (triu) ? uword(0) : uword(1);}
\DoxyCodeLine{359   \textcolor{keyword}{const} \textcolor{keywordtype}{bool}  is\_alias = U.is\_alias(actual\_out);}
\DoxyCodeLine{360   }
\DoxyCodeLine{361   T    rcond  = T(0);}
\DoxyCodeLine{362   \textcolor{keywordtype}{bool} status = \textcolor{keyword}{false};}
\DoxyCodeLine{363   }
\DoxyCodeLine{364   \mbox{\hyperlink{classMat}{Mat<eT>}}  tmp;}
\DoxyCodeLine{365   \mbox{\hyperlink{classMat}{Mat<eT>}}\& out = (is\_alias) ? tmp : actual\_out;}
\DoxyCodeLine{366   }
\DoxyCodeLine{367   status = auxlib::solve\_trimat\_rcond(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), layout, allow\_ugly);  \textcolor{comment}{// A is not modified}}
\DoxyCodeLine{368   }
\DoxyCodeLine{369   \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{true}) \&\& (rcond > T(0)) \&\& (rcond < auxlib::epsilon\_lapack(\mbox{\hyperlink{structA}{A}})) )}
\DoxyCodeLine{370     \{}
\DoxyCodeLine{371     arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): solution computed, but system is singular to working precision (rcond: "{}}, rcond, \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{372     \}}
\DoxyCodeLine{373   }
\DoxyCodeLine{374   }
\DoxyCodeLine{375   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{376     \{}
\DoxyCodeLine{377     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_tri::apply(): solving rank deficient system"{}});}
\DoxyCodeLine{378     }
\DoxyCodeLine{379     \textcolor{keywordflow}{if}(rcond > T(0))}
\DoxyCodeLine{380       \{}
\DoxyCodeLine{381       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular (rcond: "{}}, rcond, \textcolor{stringliteral}{"{}); attempting approx solution"{}});}
\DoxyCodeLine{382       \}}
\DoxyCodeLine{383     \textcolor{keywordflow}{else}}
\DoxyCodeLine{384       \{}
\DoxyCodeLine{385       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular; attempting approx solution"{}});}
\DoxyCodeLine{386       \}}
\DoxyCodeLine{387     }
\DoxyCodeLine{388     \mbox{\hyperlink{classMat}{Mat<eT>}} triA = (triu) ? trimatu(\mbox{\hyperlink{structA}{A}}) : trimatl(\mbox{\hyperlink{structA}{A}});  \textcolor{comment}{// trimatu() and trimatl() return the same type}}
\DoxyCodeLine{389     }
\DoxyCodeLine{390     status = auxlib::solve\_approx\_svd(out, triA, B\_expr.get\_ref());  \textcolor{comment}{// triA is overwritten}}
\DoxyCodeLine{391     \}}
\DoxyCodeLine{392   }
\DoxyCodeLine{393   }
\DoxyCodeLine{394   \textcolor{keywordflow}{if}(is\_alias)  \{ actual\_out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(out); \}}
\DoxyCodeLine{395   }
\DoxyCodeLine{396   \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{397   \}}
\DoxyCodeLine{398 }
\DoxyCodeLine{399 }
\DoxyCodeLine{400 }
\DoxyCodeLine{401 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{402 \textcolor{keyword}{inline}}
\DoxyCodeLine{403 \textcolor{keywordtype}{void}}
\DoxyCodeLine{404 glue\_solve\_tri::apply(\mbox{\hyperlink{classMat}{Mat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classGlue}{Glue<T1,T2,glue\_solve\_tri>}}\& X)}
\DoxyCodeLine{405   \{}
\DoxyCodeLine{406   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{407   }
\DoxyCodeLine{408   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} status = glue\_solve\_tri::apply( out, X.A, X.B, X.aux\_uword );}
\DoxyCodeLine{409   }
\DoxyCodeLine{410   \textcolor{keywordflow}{if}(status == \textcolor{keyword}{false})}
\DoxyCodeLine{411     \{}
\DoxyCodeLine{412     out.soft\_reset();}
\DoxyCodeLine{413     arma\_stop\_runtime\_error(\textcolor{stringliteral}{"{}solve(): solution not found"{}});}
\DoxyCodeLine{414     \}}
\DoxyCodeLine{415   \}}
\DoxyCodeLine{416 }
\DoxyCodeLine{417 }
\DoxyCodeLine{418 }
\DoxyCodeLine{419 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{420 \textcolor{keyword}{inline}}
\DoxyCodeLine{421 \textcolor{keywordtype}{bool}}
\DoxyCodeLine{422 glue\_solve\_tri::apply(\mbox{\hyperlink{classMat}{Mat<eT>}}\& actual\_out, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T1>}}\& A\_expr, \textcolor{keyword}{const} \mbox{\hyperlink{structBase}{Base<eT,T2>}}\& B\_expr, \textcolor{keyword}{const} uword flags)}
\DoxyCodeLine{423   \{}
\DoxyCodeLine{424   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{425   }
\DoxyCodeLine{426   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} get\_pod\_type<eT>::result T;}
\DoxyCodeLine{427   }
\DoxyCodeLine{428   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} fast         = bool(flags \& solve\_opts::flag\_fast        );}
\DoxyCodeLine{429   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} equilibrate  = bool(flags \& solve\_opts::flag\_equilibrate );}
\DoxyCodeLine{430   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_approx    = bool(flags \& solve\_opts::flag\_no\_approx   );}
\DoxyCodeLine{431   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} triu         = bool(flags \& solve\_opts::flag\_triu        );}
\DoxyCodeLine{432   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} tril         = bool(flags \& solve\_opts::flag\_tril        );}
\DoxyCodeLine{433   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} allow\_ugly   = bool(flags \& solve\_opts::flag\_allow\_ugly  );}
\DoxyCodeLine{434   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} likely\_sympd = bool(flags \& solve\_opts::flag\_likely\_sympd);}
\DoxyCodeLine{435   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} refine       = bool(flags \& solve\_opts::flag\_refine      );}
\DoxyCodeLine{436   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} no\_trimat    = bool(flags \& solve\_opts::flag\_no\_trimat   );}
\DoxyCodeLine{437   }
\DoxyCodeLine{438   arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_tri::apply(): enabled flags:"{}});}
\DoxyCodeLine{439   }
\DoxyCodeLine{440   \textcolor{keywordflow}{if}(fast        )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}fast"{}});         \}}
\DoxyCodeLine{441   \textcolor{keywordflow}{if}(equilibrate )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}equilibrate"{}});  \}}
\DoxyCodeLine{442   \textcolor{keywordflow}{if}(no\_approx   )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_approx"{}});    \}}
\DoxyCodeLine{443   \textcolor{keywordflow}{if}(triu        )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}triu"{}});         \}}
\DoxyCodeLine{444   \textcolor{keywordflow}{if}(tril        )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}tril"{}});         \}}
\DoxyCodeLine{445   \textcolor{keywordflow}{if}(allow\_ugly  )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}allow\_ugly"{}});   \}}
\DoxyCodeLine{446   \textcolor{keywordflow}{if}(likely\_sympd)  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}likely\_sympd"{}}); \}}
\DoxyCodeLine{447   \textcolor{keywordflow}{if}(refine      )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}refine"{}});       \}}
\DoxyCodeLine{448   \textcolor{keywordflow}{if}(no\_trimat   )  \{ arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}no\_trimat"{}});    \}}
\DoxyCodeLine{449   }
\DoxyCodeLine{450   \textcolor{keywordflow}{if}(no\_trimat || equilibrate || refine)}
\DoxyCodeLine{451     \{}
\DoxyCodeLine{452     \textcolor{keyword}{const} uword mask = \string~(solve\_opts::flag\_triu | solve\_opts::flag\_tril);}
\DoxyCodeLine{453     }
\DoxyCodeLine{454     \textcolor{keywordflow}{return} glue\_solve\_gen::apply(actual\_out, ((triu) ? trimatu(A\_expr.get\_ref()) : trimatl(A\_expr.get\_ref())), B\_expr, (flags \& mask));}
\DoxyCodeLine{455     \}}
\DoxyCodeLine{456   }
\DoxyCodeLine{457   \textcolor{keywordflow}{if}(likely\_sympd)  \{ arma\_debug\_warn\_level(1, \textcolor{stringliteral}{"{}solve(): option 'likely\_sympd' ignored for triangular matrix"{}}); \}}
\DoxyCodeLine{458   }
\DoxyCodeLine{459   \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} U(A\_expr.get\_ref());}
\DoxyCodeLine{460   \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& \mbox{\hyperlink{structA}{A}}     = U.M;}
\DoxyCodeLine{461   }
\DoxyCodeLine{462   arma\_debug\_check( (\mbox{\hyperlink{structA}{A}}.is\_square() == \textcolor{keyword}{false}), \textcolor{stringliteral}{"{}solve(): matrix marked as triangular must be square sized"{}} );}
\DoxyCodeLine{463   }
\DoxyCodeLine{464   \textcolor{keyword}{const} uword layout   = (triu) ? uword(0) : uword(1);}
\DoxyCodeLine{465   \textcolor{keyword}{const} \textcolor{keywordtype}{bool}  is\_alias = U.is\_alias(actual\_out);}
\DoxyCodeLine{466   }
\DoxyCodeLine{467   T    rcond  = T(0);}
\DoxyCodeLine{468   \textcolor{keywordtype}{bool} status = \textcolor{keyword}{false};}
\DoxyCodeLine{469   }
\DoxyCodeLine{470   \mbox{\hyperlink{classMat}{Mat<eT>}}  tmp;}
\DoxyCodeLine{471   \mbox{\hyperlink{classMat}{Mat<eT>}}\& out = (is\_alias) ? tmp : actual\_out;}
\DoxyCodeLine{472   }
\DoxyCodeLine{473   \textcolor{keywordflow}{if}(fast)}
\DoxyCodeLine{474     \{}
\DoxyCodeLine{475     status = auxlib::solve\_trimat\_fast(out, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), layout);  \textcolor{comment}{// A is not modified}}
\DoxyCodeLine{476     \}}
\DoxyCodeLine{477   \textcolor{keywordflow}{else}}
\DoxyCodeLine{478     \{}
\DoxyCodeLine{479     status = auxlib::solve\_trimat\_rcond(out, rcond, \mbox{\hyperlink{structA}{A}}, B\_expr.get\_ref(), layout, allow\_ugly);  \textcolor{comment}{// A is not modified}}
\DoxyCodeLine{480     \}}
\DoxyCodeLine{481   }
\DoxyCodeLine{482   \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{true}) \&\& (rcond > T(0)) \&\& (rcond < auxlib::epsilon\_lapack(\mbox{\hyperlink{structA}{A}})) )}
\DoxyCodeLine{483     \{}
\DoxyCodeLine{484     arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): solution computed, but system is singular to working precision (rcond: "{}}, rcond, \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{485     \}}
\DoxyCodeLine{486   }
\DoxyCodeLine{487   }
\DoxyCodeLine{488   \textcolor{keywordflow}{if}( (status == \textcolor{keyword}{false}) \&\& (no\_approx == \textcolor{keyword}{false}) )}
\DoxyCodeLine{489     \{}
\DoxyCodeLine{490     arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}glue\_solve\_tri::apply(): solving rank deficient system"{}});}
\DoxyCodeLine{491     }
\DoxyCodeLine{492     \textcolor{keywordflow}{if}(rcond > T(0))}
\DoxyCodeLine{493       \{}
\DoxyCodeLine{494       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular (rcond: "{}}, rcond, \textcolor{stringliteral}{"{}); attempting approx solution"{}});}
\DoxyCodeLine{495       \}}
\DoxyCodeLine{496     \textcolor{keywordflow}{else}}
\DoxyCodeLine{497       \{}
\DoxyCodeLine{498       arma\_debug\_warn\_level(2, \textcolor{stringliteral}{"{}solve(): system is singular; attempting approx solution"{}});}
\DoxyCodeLine{499       \}}
\DoxyCodeLine{500     }
\DoxyCodeLine{501     \mbox{\hyperlink{classMat}{Mat<eT>}} triA = (triu) ? trimatu(\mbox{\hyperlink{structA}{A}}) : trimatl(\mbox{\hyperlink{structA}{A}});  \textcolor{comment}{// trimatu() and trimatl() return the same type}}
\DoxyCodeLine{502     }
\DoxyCodeLine{503     status = auxlib::solve\_approx\_svd(out, triA, B\_expr.get\_ref());  \textcolor{comment}{// triA is overwritten}}
\DoxyCodeLine{504     \}}
\DoxyCodeLine{505   }
\DoxyCodeLine{506   }
\DoxyCodeLine{507   \textcolor{keywordflow}{if}(is\_alias)  \{ actual\_out.\mbox{\hyperlink{group__Mat_gaff06a75771f96605f7cc4f8c6b3fceb7}{steal\_mem}}(out); \}}
\DoxyCodeLine{508   }
\DoxyCodeLine{509   \textcolor{keywordflow}{return} status;}
\DoxyCodeLine{510   \}}
\DoxyCodeLine{511 }
\DoxyCodeLine{512 }
\DoxyCodeLine{513 }

\end{DoxyCode}
