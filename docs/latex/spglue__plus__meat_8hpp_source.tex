\hypertarget{spglue__plus__meat_8hpp_source}{}\doxysection{spglue\+\_\+plus\+\_\+meat.\+hpp}
\label{spglue__plus__meat_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/spglue\_plus\_meat.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/spglue\_plus\_meat.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{23 arma\_hot}
\DoxyCodeLine{24 \textcolor{keyword}{inline}}
\DoxyCodeLine{25 \textcolor{keywordtype}{void}}
\DoxyCodeLine{26 spglue\_plus::apply(\mbox{\hyperlink{classSpMat}{SpMat<typename T1::elem\_type>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classSpGlue}{SpGlue<T1,T2,spglue\_plus>}}\& X)}
\DoxyCodeLine{27   \{}
\DoxyCodeLine{28   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{29   }
\DoxyCodeLine{30   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT;}
\DoxyCodeLine{31   }
\DoxyCodeLine{32   \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy<T1>}} pa(X.A);}
\DoxyCodeLine{33   \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>}} pb(X.B);}
\DoxyCodeLine{34   }
\DoxyCodeLine{35   \textcolor{keyword}{const} \textcolor{keywordtype}{bool} is\_alias = pa.is\_alias(out) || pb.is\_alias(out);}
\DoxyCodeLine{36   }
\DoxyCodeLine{37   \textcolor{keywordflow}{if}(is\_alias == \textcolor{keyword}{false})}
\DoxyCodeLine{38     \{}
\DoxyCodeLine{39     spglue\_plus::apply\_noalias(out, pa, pb);}
\DoxyCodeLine{40     \}}
\DoxyCodeLine{41   \textcolor{keywordflow}{else}}
\DoxyCodeLine{42     \{}
\DoxyCodeLine{43     \mbox{\hyperlink{classSpMat}{SpMat<eT>}} tmp;}
\DoxyCodeLine{44     }
\DoxyCodeLine{45     spglue\_plus::apply\_noalias(tmp, pa, pb);}
\DoxyCodeLine{46     }
\DoxyCodeLine{47     out.\mbox{\hyperlink{group__SpMat_ga17a2f694c4d85832d3744cdb08385213}{steal\_mem}}(tmp);}
\DoxyCodeLine{48     \}}
\DoxyCodeLine{49   \}}
\DoxyCodeLine{50 }
\DoxyCodeLine{51 }
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{54 arma\_hot}
\DoxyCodeLine{55 \textcolor{keyword}{inline}}
\DoxyCodeLine{56 \textcolor{keywordtype}{void}}
\DoxyCodeLine{57 spglue\_plus::apply\_noalias(\mbox{\hyperlink{classSpMat}{SpMat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy<T1>}}\& pa, \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>}}\& pb)}
\DoxyCodeLine{58   \{}
\DoxyCodeLine{59   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{60   }
\DoxyCodeLine{61   arma\_debug\_assert\_same\_size(pa.get\_n\_rows(), pa.get\_n\_cols(), pb.get\_n\_rows(), pb.get\_n\_cols(), \textcolor{stringliteral}{"{}addition"{}});}
\DoxyCodeLine{62   }
\DoxyCodeLine{63   \textcolor{keywordflow}{if}(pa.get\_n\_nonzero() == 0)  \{ out = pb.Q; \textcolor{keywordflow}{return}; \}}
\DoxyCodeLine{64   \textcolor{keywordflow}{if}(pb.get\_n\_nonzero() == 0)  \{ out = pa.Q; \textcolor{keywordflow}{return}; \}}
\DoxyCodeLine{65   }
\DoxyCodeLine{66   \textcolor{keyword}{const} uword max\_n\_nonzero = pa.get\_n\_nonzero() + pb.get\_n\_nonzero();}
\DoxyCodeLine{67   }
\DoxyCodeLine{68   \textcolor{comment}{// Resize memory to upper bound}}
\DoxyCodeLine{69   out.\mbox{\hyperlink{group__SpMat_gac9162550cc7b009108f58ebf931be224}{reserve}}(pa.get\_n\_rows(), pa.get\_n\_cols(), max\_n\_nonzero);}
\DoxyCodeLine{70   }
\DoxyCodeLine{71   \textcolor{comment}{// Now iterate across both matrices.}}
\DoxyCodeLine{72   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T1>::const\_iterator\_type}} x\_it  = pa.begin();}
\DoxyCodeLine{73   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T1>::const\_iterator\_type}} x\_end = pa.end();}
\DoxyCodeLine{74   }
\DoxyCodeLine{75   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>::const\_iterator\_type}} y\_it  = pb.begin();}
\DoxyCodeLine{76   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>::const\_iterator\_type}} y\_end = pb.end();}
\DoxyCodeLine{77   }
\DoxyCodeLine{78   uword count = 0;}
\DoxyCodeLine{79   }
\DoxyCodeLine{80   \textcolor{keywordflow}{while}( (x\_it != x\_end) || (y\_it != y\_end) )}
\DoxyCodeLine{81     \{}
\DoxyCodeLine{82     eT out\_val;}
\DoxyCodeLine{83     }
\DoxyCodeLine{84     \textcolor{keyword}{const} uword x\_it\_col = x\_it.col();}
\DoxyCodeLine{85     \textcolor{keyword}{const} uword x\_it\_row = x\_it.row();}
\DoxyCodeLine{86     }
\DoxyCodeLine{87     \textcolor{keyword}{const} uword y\_it\_col = y\_it.col();}
\DoxyCodeLine{88     \textcolor{keyword}{const} uword y\_it\_row = y\_it.row();}
\DoxyCodeLine{89     }
\DoxyCodeLine{90     \textcolor{keywordtype}{bool} use\_y\_loc = \textcolor{keyword}{false};}
\DoxyCodeLine{91     }
\DoxyCodeLine{92     \textcolor{keywordflow}{if}(x\_it == y\_it)}
\DoxyCodeLine{93       \{}
\DoxyCodeLine{94       out\_val = (*x\_it) + (*y\_it);}
\DoxyCodeLine{95       }
\DoxyCodeLine{96       ++x\_it;}
\DoxyCodeLine{97       ++y\_it;}
\DoxyCodeLine{98       \}}
\DoxyCodeLine{99     \textcolor{keywordflow}{else}}
\DoxyCodeLine{100       \{}
\DoxyCodeLine{101       \textcolor{keywordflow}{if}((x\_it\_col < y\_it\_col) || ((x\_it\_col == y\_it\_col) \&\& (x\_it\_row < y\_it\_row))) \textcolor{comment}{// if y is closer to the end}}
\DoxyCodeLine{102         \{}
\DoxyCodeLine{103         out\_val = (*x\_it);}
\DoxyCodeLine{104         }
\DoxyCodeLine{105         ++x\_it;}
\DoxyCodeLine{106         \}}
\DoxyCodeLine{107       \textcolor{keywordflow}{else}}
\DoxyCodeLine{108         \{}
\DoxyCodeLine{109         out\_val = (*y\_it);}
\DoxyCodeLine{110         }
\DoxyCodeLine{111         ++y\_it;}
\DoxyCodeLine{112         }
\DoxyCodeLine{113         use\_y\_loc = \textcolor{keyword}{true};}
\DoxyCodeLine{114         \}}
\DoxyCodeLine{115       \}}
\DoxyCodeLine{116     }
\DoxyCodeLine{117     \textcolor{keywordflow}{if}(out\_val != eT(0))}
\DoxyCodeLine{118       \{}
\DoxyCodeLine{119       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(out.values[count]) = out\_val;}
\DoxyCodeLine{120       }
\DoxyCodeLine{121       \textcolor{keyword}{const} uword out\_row = (use\_y\_loc == \textcolor{keyword}{false}) ? x\_it\_row : y\_it\_row;}
\DoxyCodeLine{122       \textcolor{keyword}{const} uword out\_col = (use\_y\_loc == \textcolor{keyword}{false}) ? x\_it\_col : y\_it\_col;}
\DoxyCodeLine{123       }
\DoxyCodeLine{124       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(out.row\_indices[count]) = out\_row;}
\DoxyCodeLine{125       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(out.col\_ptrs[out\_col + 1])++;}
\DoxyCodeLine{126       ++count;}
\DoxyCodeLine{127       \}}
\DoxyCodeLine{128     }
\DoxyCodeLine{129     \mbox{\hyperlink{group__debug_ga458beb676810b1e43df9f0668359e76f}{arma\_check}}( (count > max\_n\_nonzero), \textcolor{stringliteral}{"{}internal error: spglue\_plus::apply\_noalias(): count > max\_n\_nonzero"{}} );}
\DoxyCodeLine{130     \}}
\DoxyCodeLine{131   }
\DoxyCodeLine{132   \textcolor{keyword}{const} uword out\_n\_cols = out.\mbox{\hyperlink{classSpMat_a4f01c9d35f90eb836c6be489605052dd}{n\_cols}};}
\DoxyCodeLine{133   }
\DoxyCodeLine{134   uword* col\_ptrs = access::rwp(out.col\_ptrs);}
\DoxyCodeLine{135   }
\DoxyCodeLine{136   \textcolor{comment}{// Fix column pointers to be cumulative.}}
\DoxyCodeLine{137   \textcolor{keywordflow}{for}(uword c = 1; c <= out\_n\_cols; ++c)}
\DoxyCodeLine{138     \{}
\DoxyCodeLine{139     col\_ptrs[c] += col\_ptrs[c -\/ 1];}
\DoxyCodeLine{140     \}}
\DoxyCodeLine{141   }
\DoxyCodeLine{142   \textcolor{keywordflow}{if}(count < max\_n\_nonzero)}
\DoxyCodeLine{143     \{}
\DoxyCodeLine{144     \textcolor{keywordflow}{if}(count <= (max\_n\_nonzero/2))}
\DoxyCodeLine{145       \{}
\DoxyCodeLine{146       out.mem\_resize(count);}
\DoxyCodeLine{147       \}}
\DoxyCodeLine{148     \textcolor{keywordflow}{else}}
\DoxyCodeLine{149       \{}
\DoxyCodeLine{150       \textcolor{comment}{// quick resize without reallocating memory and copying data}}
\DoxyCodeLine{151       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(         out.\mbox{\hyperlink{classSpMat_a71a87b0de327d5643983dd21f455b984}{n\_nonzero}}) = count;}
\DoxyCodeLine{152       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(     out.values[count]) = eT(0);}
\DoxyCodeLine{153       \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(out.row\_indices[count]) = uword(0);}
\DoxyCodeLine{154       \}}
\DoxyCodeLine{155     \}}
\DoxyCodeLine{156   \}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158 }
\DoxyCodeLine{159 }
\DoxyCodeLine{160 \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{161 arma\_hot}
\DoxyCodeLine{162 \textcolor{keyword}{inline}}
\DoxyCodeLine{163 \textcolor{keywordtype}{void}}
\DoxyCodeLine{164 spglue\_plus::apply\_noalias(\mbox{\hyperlink{classSpMat}{SpMat<eT>}}\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT>}}\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT>}}\& \mbox{\hyperlink{structB}{B}})}
\DoxyCodeLine{165   \{}
\DoxyCodeLine{166   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{167   }
\DoxyCodeLine{168   \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy< SpMat<eT>}} > pa(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{169   \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy< SpMat<eT>}} > pb(\mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{170   }
\DoxyCodeLine{171   spglue\_plus::apply\_noalias(out, pa, pb);}
\DoxyCodeLine{172   \}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174 }
\DoxyCodeLine{175 }
\DoxyCodeLine{176 \textcolor{comment}{//}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 }
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{181 \textcolor{keyword}{inline}}
\DoxyCodeLine{182 \textcolor{keywordtype}{void}}
\DoxyCodeLine{183 spglue\_plus\_mixed::apply(\mbox{\hyperlink{classSpMat}{SpMat}}<\textcolor{keyword}{typename} eT\_promoter<T1,T2>::eT>\& out, \textcolor{keyword}{const} \mbox{\hyperlink{classmtSpGlue}{mtSpGlue}}<\textcolor{keyword}{typename} eT\_promoter<T1,T2>::eT, T1, T2, \mbox{\hyperlink{classspglue__plus__mixed}{spglue\_plus\_mixed}}>\& expr)}
\DoxyCodeLine{184   \{}
\DoxyCodeLine{185   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{186   }
\DoxyCodeLine{187   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT1;}
\DoxyCodeLine{188   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T2::elem\_type eT2;}
\DoxyCodeLine{189   }
\DoxyCodeLine{190   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} promote\_type<eT1,eT2>::result out\_eT;}
\DoxyCodeLine{191   }
\DoxyCodeLine{192   \mbox{\hyperlink{structpromote__type}{promote\_type<eT1,eT2>::check}}();}
\DoxyCodeLine{193   }
\DoxyCodeLine{194   \textcolor{keywordflow}{if}( (\mbox{\hyperlink{structis__same__type}{is\_same\_type<eT1,out\_eT>::no}}) \&\& (\mbox{\hyperlink{structis__same__type}{is\_same\_type<eT2,out\_eT>::yes}}) )}
\DoxyCodeLine{195     \{}
\DoxyCodeLine{196     \textcolor{comment}{// upgrade T1}}
\DoxyCodeLine{197     }
\DoxyCodeLine{198     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T1>}} UA(expr.A);}
\DoxyCodeLine{199     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T2>}} UB(expr.B);}
\DoxyCodeLine{200     }
\DoxyCodeLine{201     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT1>}}\& \mbox{\hyperlink{structA}{A}} = UA.M;}
\DoxyCodeLine{202     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT2>}}\& \mbox{\hyperlink{structB}{B}} = UB.M;}
\DoxyCodeLine{203     }
\DoxyCodeLine{204     \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}} AA(\mbox{\hyperlink{structarma__layout__indicator}{arma\_layout\_indicator}}(), \mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{205     }
\DoxyCodeLine{206     \textcolor{keywordflow}{for}(uword i=0; i < \mbox{\hyperlink{structA}{A}}.n\_nonzero; ++i)  \{ \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(AA.values[i]) = out\_eT(\mbox{\hyperlink{structA}{A}}.values[i]); \}}
\DoxyCodeLine{207     }
\DoxyCodeLine{208     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}}\& BB = \textcolor{keyword}{reinterpret\_cast<} \textcolor{keyword}{const }\mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}}\& \textcolor{keyword}{>}(\mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{209     }
\DoxyCodeLine{210     out = AA + BB;}
\DoxyCodeLine{211     \}}
\DoxyCodeLine{212   \textcolor{keywordflow}{else}}
\DoxyCodeLine{213   \textcolor{keywordflow}{if}( (\mbox{\hyperlink{structis__same__type}{is\_same\_type<eT1,out\_eT>::yes}}) \&\& (\mbox{\hyperlink{structis__same__type}{is\_same\_type<eT2,out\_eT>::no}}) )}
\DoxyCodeLine{214     \{}
\DoxyCodeLine{215     \textcolor{comment}{// upgrade T2 }}
\DoxyCodeLine{216     }
\DoxyCodeLine{217     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T1>}} UA(expr.A);}
\DoxyCodeLine{218     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T2>}} UB(expr.B);}
\DoxyCodeLine{219     }
\DoxyCodeLine{220     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT1>}}\& \mbox{\hyperlink{structA}{A}} = UA.M;}
\DoxyCodeLine{221     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT2>}}\& \mbox{\hyperlink{structB}{B}} = UB.M;}
\DoxyCodeLine{222     }
\DoxyCodeLine{223     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}}\& AA = \textcolor{keyword}{reinterpret\_cast<} \textcolor{keyword}{const }\mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}}\& \textcolor{keyword}{>}(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{224     }
\DoxyCodeLine{225     \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}} BB(\mbox{\hyperlink{structarma__layout__indicator}{arma\_layout\_indicator}}(), \mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{226     }
\DoxyCodeLine{227     \textcolor{keywordflow}{for}(uword i=0; i < \mbox{\hyperlink{structB}{B}}.n\_nonzero; ++i)  \{ \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(BB.values[i]) = out\_eT(\mbox{\hyperlink{structB}{B}}.values[i]); \}}
\DoxyCodeLine{228     }
\DoxyCodeLine{229     out = AA + BB;}
\DoxyCodeLine{230     \}}
\DoxyCodeLine{231   \textcolor{keywordflow}{else}}
\DoxyCodeLine{232     \{}
\DoxyCodeLine{233     \textcolor{comment}{// upgrade T1 and T2}}
\DoxyCodeLine{234     }
\DoxyCodeLine{235     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T1>}} UA(expr.A);}
\DoxyCodeLine{236     \textcolor{keyword}{const} \mbox{\hyperlink{structunwrap__spmat}{unwrap\_spmat<T2>}} UB(expr.B);}
\DoxyCodeLine{237     }
\DoxyCodeLine{238     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT1>}}\& \mbox{\hyperlink{structA}{A}} = UA.M;}
\DoxyCodeLine{239     \textcolor{keyword}{const} \mbox{\hyperlink{classSpMat}{SpMat<eT2>}}\& \mbox{\hyperlink{structB}{B}} = UB.M;}
\DoxyCodeLine{240     }
\DoxyCodeLine{241     \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}} AA(\mbox{\hyperlink{structarma__layout__indicator}{arma\_layout\_indicator}}(), \mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{242     \mbox{\hyperlink{classSpMat}{SpMat<out\_eT>}} BB(\mbox{\hyperlink{structarma__layout__indicator}{arma\_layout\_indicator}}(), \mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{243     }
\DoxyCodeLine{244     \textcolor{keywordflow}{for}(uword i=0; i < \mbox{\hyperlink{structA}{A}}.n\_nonzero; ++i)  \{ \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(AA.values[i]) = out\_eT(\mbox{\hyperlink{structA}{A}}.values[i]); \}}
\DoxyCodeLine{245     \textcolor{keywordflow}{for}(uword i=0; i < \mbox{\hyperlink{structB}{B}}.n\_nonzero; ++i)  \{ \mbox{\hyperlink{classaccess_a90cb80857bc3814f3661fe952f7c97c4}{access::rw}}(BB.values[i]) = out\_eT(\mbox{\hyperlink{structB}{B}}.values[i]); \}}
\DoxyCodeLine{246     }
\DoxyCodeLine{247     out = AA + BB;}
\DoxyCodeLine{248     \}}
\DoxyCodeLine{249   \}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 }
\DoxyCodeLine{252 }
\DoxyCodeLine{253 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>}
\DoxyCodeLine{254 \textcolor{keyword}{inline}}
\DoxyCodeLine{255 \textcolor{keywordtype}{void}}
\DoxyCodeLine{256 spglue\_plus\_mixed::dense\_plus\_sparse(\mbox{\hyperlink{classMat}{Mat}}< \textcolor{keyword}{typename} promote\_type<typename T1::elem\_type, typename T2::elem\_type >::result>\& out, \textcolor{keyword}{const} T1\& X, \textcolor{keyword}{const} T2\& Y)}
\DoxyCodeLine{257   \{}
\DoxyCodeLine{258   arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{259   }
\DoxyCodeLine{260   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T1::elem\_type eT1;}
\DoxyCodeLine{261   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} T2::elem\_type eT2;}
\DoxyCodeLine{262   }
\DoxyCodeLine{263   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} promote\_type<eT1,eT2>::result out\_eT;}
\DoxyCodeLine{264   }
\DoxyCodeLine{265   \mbox{\hyperlink{structpromote__type}{promote\_type<eT1,eT2>::check}}();}
\DoxyCodeLine{266   }
\DoxyCodeLine{267   \textcolor{keywordflow}{if}(\mbox{\hyperlink{structis__same__type}{is\_same\_type<eT1,out\_eT>::no}})}
\DoxyCodeLine{268     \{}
\DoxyCodeLine{269     out = \mbox{\hyperlink{classconv__to}{conv\_to< Mat<out\_eT>}} >::from(X);}
\DoxyCodeLine{270     \}}
\DoxyCodeLine{271   \textcolor{keywordflow}{else}}
\DoxyCodeLine{272     \{}
\DoxyCodeLine{273     \textcolor{keyword}{const} \mbox{\hyperlink{structquasi__unwrap}{quasi\_unwrap<T1>}} UA(X);}
\DoxyCodeLine{274     }
\DoxyCodeLine{275     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT1>}}\& \mbox{\hyperlink{structA}{A}} = UA.M;}
\DoxyCodeLine{276     }
\DoxyCodeLine{277     out = \textcolor{keyword}{reinterpret\_cast<} \textcolor{keyword}{const }\mbox{\hyperlink{classMat}{Mat<out\_eT>}}\& \textcolor{keyword}{>}(\mbox{\hyperlink{structA}{A}});}
\DoxyCodeLine{278     \}}
\DoxyCodeLine{279   }
\DoxyCodeLine{280   \textcolor{keyword}{const} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>}} pb(Y);}
\DoxyCodeLine{281   }
\DoxyCodeLine{282   arma\_debug\_assert\_same\_size( out.\mbox{\hyperlink{classSpMat_a84c06dc8c923afc6e779fd6ab79b4c26}{n\_rows}}, out.\mbox{\hyperlink{classSpMat_a4f01c9d35f90eb836c6be489605052dd}{n\_cols}}, pb.get\_n\_rows(), pb.get\_n\_cols(), \textcolor{stringliteral}{"{}addition"{}} );}
\DoxyCodeLine{283   }
\DoxyCodeLine{284   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>::const\_iterator\_type}} it     = pb.begin();}
\DoxyCodeLine{285   \textcolor{keyword}{typename} \mbox{\hyperlink{classSpProxy}{SpProxy<T2>::const\_iterator\_type}} it\_end = pb.end();}
\DoxyCodeLine{286   }
\DoxyCodeLine{287   \textcolor{keywordflow}{while}(it != it\_end)}
\DoxyCodeLine{288     \{}
\DoxyCodeLine{289     out.at(it.row(), it.col()) += out\_eT(*it);}
\DoxyCodeLine{290     ++it;}
\DoxyCodeLine{291     \}}
\DoxyCodeLine{292   \}}
\DoxyCodeLine{293 }
\DoxyCodeLine{294 }
\DoxyCodeLine{295 }

\end{DoxyCode}
