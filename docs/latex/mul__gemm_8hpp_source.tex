\hypertarget{mul__gemm_8hpp_source}{}\doxysection{mul\+\_\+gemm.\+hpp}
\label{mul__gemm_8hpp_source}\index{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/mul\_gemm.hpp@{/Users/motiwari/Desktop/BanditPAM/headers/carma/extern/armadillo-\/code/include/armadillo\_bits/mul\_gemm.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// Copyright 2008-\/2016 Conrad Sanderson (http://conradsanderson.id.au)}}
\DoxyCodeLine{2 \textcolor{comment}{// Copyright 2008-\/2016 National ICT Australia (NICTA)}}
\DoxyCodeLine{3 \textcolor{comment}{// }}
\DoxyCodeLine{4 \textcolor{comment}{// Licensed under the Apache License, Version 2.0 (the "{}License"{});}}
\DoxyCodeLine{5 \textcolor{comment}{// you may not use this file except in compliance with the License.}}
\DoxyCodeLine{6 \textcolor{comment}{// You may obtain a copy of the License at}}
\DoxyCodeLine{7 \textcolor{comment}{// http://www.apache.org/licenses/LICENSE-\/2.0}}
\DoxyCodeLine{8 \textcolor{comment}{// }}
\DoxyCodeLine{9 \textcolor{comment}{// Unless required by applicable law or agreed to in writing, software}}
\DoxyCodeLine{10 \textcolor{comment}{// distributed under the License is distributed on an "{}AS IS"{} BASIS,}}
\DoxyCodeLine{11 \textcolor{comment}{// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.}}
\DoxyCodeLine{12 \textcolor{comment}{// See the License for the specific language governing permissions and}}
\DoxyCodeLine{13 \textcolor{comment}{// limitations under the License.}}
\DoxyCodeLine{14 \textcolor{comment}{// -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 }
\DoxyCodeLine{19 }
\DoxyCodeLine{20 }
\DoxyCodeLine{21 }
\DoxyCodeLine{23 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classgemm__emul__tinysq}{gemm\_emul\_tinysq}}}
\DoxyCodeLine{25   \{}
\DoxyCodeLine{26   \textcolor{keyword}{public}:}
\DoxyCodeLine{27   }
\DoxyCodeLine{28   }
\DoxyCodeLine{29   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{30   arma\_cold}
\DoxyCodeLine{31   \textcolor{keyword}{inline}}
\DoxyCodeLine{32   \textcolor{keyword}{static}}
\DoxyCodeLine{33   \textcolor{keywordtype}{void}}
\DoxyCodeLine{34   apply}
\DoxyCodeLine{35     (}
\DoxyCodeLine{36           \mbox{\hyperlink{classMat}{Mat<eT>}}\& C,}
\DoxyCodeLine{37     \textcolor{keyword}{const} TA\&      \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{38     \textcolor{keyword}{const} TB\&      \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{39     \textcolor{keyword}{const} eT       alpha = eT(1),}
\DoxyCodeLine{40     \textcolor{keyword}{const} eT       beta  = eT(0)}
\DoxyCodeLine{41     )}
\DoxyCodeLine{42     \{}
\DoxyCodeLine{43     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{44     }
\DoxyCodeLine{45     \textcolor{keywordflow}{switch}(\mbox{\hyperlink{structA}{A}}.n\_rows)}
\DoxyCodeLine{46       \{}
\DoxyCodeLine{47       \textcolor{keywordflow}{case}  4:  \mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}( C.\mbox{\hyperlink{group__Mat_gad6a294c2ed4726f7b4b95e750ddfeb7a}{colptr}}(3), \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}.colptr(3), alpha, beta );}
\DoxyCodeLine{48       \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{49       \textcolor{keywordflow}{case}  3:  \mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}( C.\mbox{\hyperlink{group__Mat_gad6a294c2ed4726f7b4b95e750ddfeb7a}{colptr}}(2), \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}.colptr(2), alpha, beta );}
\DoxyCodeLine{50       \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{51       \textcolor{keywordflow}{case}  2:  \mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}( C.\mbox{\hyperlink{group__Mat_gad6a294c2ed4726f7b4b95e750ddfeb7a}{colptr}}(1), \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}.colptr(1), alpha, beta );}
\DoxyCodeLine{52       \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{53       \textcolor{keywordflow}{case}  1:  \mbox{\hyperlink{classgemv__emul__tinysq}{gemv\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}( C.\mbox{\hyperlink{group__Mat_gad6a294c2ed4726f7b4b95e750ddfeb7a}{colptr}}(0), \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}.colptr(0), alpha, beta );}
\DoxyCodeLine{54       \textcolor{comment}{// fallthrough}}
\DoxyCodeLine{55       \textcolor{keywordflow}{default}:  ;}
\DoxyCodeLine{56       \}}
\DoxyCodeLine{57     \}}
\DoxyCodeLine{58   }
\DoxyCodeLine{59   \};}
\DoxyCodeLine{60 }
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{64 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} do\_trans\_B=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{65 \textcolor{keyword}{class }\mbox{\hyperlink{classgemm__emul__large}{gemm\_emul\_large}}}
\DoxyCodeLine{66   \{}
\DoxyCodeLine{67   \textcolor{keyword}{public}:}
\DoxyCodeLine{68   }
\DoxyCodeLine{69   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{70   arma\_hot}
\DoxyCodeLine{71   \textcolor{keyword}{inline}}
\DoxyCodeLine{72   \textcolor{keyword}{static}}
\DoxyCodeLine{73   \textcolor{keywordtype}{void}}
\DoxyCodeLine{74   apply}
\DoxyCodeLine{75     (}
\DoxyCodeLine{76           \mbox{\hyperlink{classMat}{Mat<eT>}}\& C,}
\DoxyCodeLine{77     \textcolor{keyword}{const} TA\&      \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{78     \textcolor{keyword}{const} TB\&      \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{79     \textcolor{keyword}{const} eT       alpha = eT(1),}
\DoxyCodeLine{80     \textcolor{keyword}{const} eT       beta  = eT(0)}
\DoxyCodeLine{81     )}
\DoxyCodeLine{82     \{}
\DoxyCodeLine{83     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{84 }
\DoxyCodeLine{85     \textcolor{keyword}{const} uword A\_n\_rows = \mbox{\hyperlink{structA}{A}}.n\_rows;}
\DoxyCodeLine{86     \textcolor{keyword}{const} uword A\_n\_cols = \mbox{\hyperlink{structA}{A}}.n\_cols;}
\DoxyCodeLine{87     }
\DoxyCodeLine{88     \textcolor{keyword}{const} uword B\_n\_rows = \mbox{\hyperlink{structB}{B}}.n\_rows;}
\DoxyCodeLine{89     \textcolor{keyword}{const} uword B\_n\_cols = \mbox{\hyperlink{structB}{B}}.n\_cols;}
\DoxyCodeLine{90     }
\DoxyCodeLine{91     \textcolor{keywordflow}{if}( (do\_trans\_A == \textcolor{keyword}{false}) \&\& (do\_trans\_B == \textcolor{keyword}{false}) )}
\DoxyCodeLine{92       \{}
\DoxyCodeLine{93       arma\_aligned \mbox{\hyperlink{classpodarray}{podarray<eT>}} tmp(A\_n\_cols);}
\DoxyCodeLine{94       }
\DoxyCodeLine{95       eT* A\_rowdata = tmp.memptr();}
\DoxyCodeLine{96       }
\DoxyCodeLine{97       \textcolor{keywordflow}{for}(uword row\_A=0; row\_A < A\_n\_rows; ++row\_A)}
\DoxyCodeLine{98         \{}
\DoxyCodeLine{99         tmp.copy\_row(\mbox{\hyperlink{structA}{A}}, row\_A);}
\DoxyCodeLine{100         }
\DoxyCodeLine{101         \textcolor{keywordflow}{for}(uword col\_B=0; col\_B < B\_n\_cols; ++col\_B)}
\DoxyCodeLine{102           \{}
\DoxyCodeLine{103           \textcolor{keyword}{const} eT acc = \mbox{\hyperlink{group__op__dot_ga7af686a7089ac5d85b44405385578283}{op\_dot::direct\_dot\_arma}}(B\_n\_rows, A\_rowdata, \mbox{\hyperlink{structB}{B}}.colptr(col\_B));}
\DoxyCodeLine{104           }
\DoxyCodeLine{105                \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B) =       acc;                          \}}
\DoxyCodeLine{106           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B) = alpha*acc;                          \}}
\DoxyCodeLine{107           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B) =       acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B); \}}
\DoxyCodeLine{108           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B) = alpha*acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(row\_A,col\_B); \}}
\DoxyCodeLine{109           \}}
\DoxyCodeLine{110         \}}
\DoxyCodeLine{111       \}}
\DoxyCodeLine{112     \textcolor{keywordflow}{else}}
\DoxyCodeLine{113     \textcolor{keywordflow}{if}( (do\_trans\_A == \textcolor{keyword}{true}) \&\& (do\_trans\_B == \textcolor{keyword}{false}) )}
\DoxyCodeLine{114       \{}
\DoxyCodeLine{115       \textcolor{keywordflow}{for}(uword col\_A=0; col\_A < A\_n\_cols; ++col\_A)}
\DoxyCodeLine{116         \{}
\DoxyCodeLine{117         \textcolor{comment}{// col\_A is interpreted as row\_A when storing the results in matrix C}}
\DoxyCodeLine{118         }
\DoxyCodeLine{119         \textcolor{keyword}{const} eT* A\_coldata = \mbox{\hyperlink{structA}{A}}.colptr(col\_A);}
\DoxyCodeLine{120         }
\DoxyCodeLine{121         \textcolor{keywordflow}{for}(uword col\_B=0; col\_B < B\_n\_cols; ++col\_B)}
\DoxyCodeLine{122           \{}
\DoxyCodeLine{123           \textcolor{keyword}{const} eT acc = \mbox{\hyperlink{group__op__dot_ga7af686a7089ac5d85b44405385578283}{op\_dot::direct\_dot\_arma}}(B\_n\_rows, A\_coldata, \mbox{\hyperlink{structB}{B}}.colptr(col\_B));}
\DoxyCodeLine{124           }
\DoxyCodeLine{125                \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B) =       acc;                          \}}
\DoxyCodeLine{126           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B) = alpha*acc;                          \}}
\DoxyCodeLine{127           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B) =       acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B); \}}
\DoxyCodeLine{128           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B) = alpha*acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,col\_B); \}}
\DoxyCodeLine{129           \}}
\DoxyCodeLine{130         \}}
\DoxyCodeLine{131       \}}
\DoxyCodeLine{132     \textcolor{keywordflow}{else}}
\DoxyCodeLine{133     \textcolor{keywordflow}{if}( (do\_trans\_A == \textcolor{keyword}{false}) \&\& (do\_trans\_B == \textcolor{keyword}{true}) )}
\DoxyCodeLine{134       \{}
\DoxyCodeLine{135       \mbox{\hyperlink{classMat}{Mat<eT>}} BB;}
\DoxyCodeLine{136       \mbox{\hyperlink{group__op__strans_gafd56208012c4a9b31acbeaf21cfa63cc}{op\_strans::apply\_mat\_noalias}}(BB, \mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{137       }
\DoxyCodeLine{138       \mbox{\hyperlink{classgemm__emul__large}{gemm\_emul\_large<false, false, use\_alpha, use\_beta>::apply}}(C, \mbox{\hyperlink{structA}{A}}, BB, alpha, beta);}
\DoxyCodeLine{139       \}}
\DoxyCodeLine{140     \textcolor{keywordflow}{else}}
\DoxyCodeLine{141     \textcolor{keywordflow}{if}( (do\_trans\_A == \textcolor{keyword}{true}) \&\& (do\_trans\_B == \textcolor{keyword}{true}) )}
\DoxyCodeLine{142       \{}
\DoxyCodeLine{143       \textcolor{comment}{// mat B\_tmp = trans(B);}}
\DoxyCodeLine{144       \textcolor{comment}{// dgemm\_arma<true, false,  use\_alpha, use\_beta>::apply(C, A, B\_tmp, alpha, beta);}}
\DoxyCodeLine{145       }
\DoxyCodeLine{146       }
\DoxyCodeLine{147       \textcolor{comment}{// By using the trans(A)*trans(B) = trans(B*A) equivalency,}}
\DoxyCodeLine{148       \textcolor{comment}{// transpose operations are not needed}}
\DoxyCodeLine{149       }
\DoxyCodeLine{150       arma\_aligned \mbox{\hyperlink{classpodarray}{podarray<eT>}} tmp(\mbox{\hyperlink{structB}{B}}.n\_cols);}
\DoxyCodeLine{151       eT* B\_rowdata = tmp.memptr();}
\DoxyCodeLine{152       }
\DoxyCodeLine{153       \textcolor{keywordflow}{for}(uword row\_B=0; row\_B < B\_n\_rows; ++row\_B)}
\DoxyCodeLine{154         \{}
\DoxyCodeLine{155         tmp.copy\_row(\mbox{\hyperlink{structB}{B}}, row\_B);}
\DoxyCodeLine{156         }
\DoxyCodeLine{157         \textcolor{keywordflow}{for}(uword col\_A=0; col\_A < A\_n\_cols; ++col\_A)}
\DoxyCodeLine{158           \{}
\DoxyCodeLine{159           \textcolor{keyword}{const} eT acc = \mbox{\hyperlink{group__op__dot_ga7af686a7089ac5d85b44405385578283}{op\_dot::direct\_dot\_arma}}(A\_n\_rows, B\_rowdata, \mbox{\hyperlink{structA}{A}}.colptr(col\_A));}
\DoxyCodeLine{160           }
\DoxyCodeLine{161                \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B) =       acc;                          \}}
\DoxyCodeLine{162           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{false}) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B) = alpha*acc;                          \}}
\DoxyCodeLine{163           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{false}) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B) =       acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B); \}}
\DoxyCodeLine{164           \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( (use\_alpha == \textcolor{keyword}{true} ) \&\& (use\_beta == \textcolor{keyword}{true} ) )  \{ C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B) = alpha*acc + beta*C.\mbox{\hyperlink{group__Mat_ga62c874c45807d7853afd231ae9f512d7}{at}}(col\_A,row\_B); \}}
\DoxyCodeLine{165           \}}
\DoxyCodeLine{166         \}}
\DoxyCodeLine{167       \}}
\DoxyCodeLine{168     \}}
\DoxyCodeLine{169   }
\DoxyCodeLine{170   \};}
\DoxyCodeLine{171   }
\DoxyCodeLine{172 }
\DoxyCodeLine{173 }
\DoxyCodeLine{174 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} do\_trans\_B=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{175 \textcolor{keyword}{class }\mbox{\hyperlink{classgemm__emul}{gemm\_emul}}}
\DoxyCodeLine{176   \{}
\DoxyCodeLine{177   \textcolor{keyword}{public}:}
\DoxyCodeLine{178   }
\DoxyCodeLine{179   }
\DoxyCodeLine{180   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{181   arma\_hot}
\DoxyCodeLine{182   \textcolor{keyword}{inline}}
\DoxyCodeLine{183   \textcolor{keyword}{static}}
\DoxyCodeLine{184   \textcolor{keywordtype}{void}}
\DoxyCodeLine{185   apply}
\DoxyCodeLine{186     (}
\DoxyCodeLine{187           \mbox{\hyperlink{classMat}{Mat<eT>}}\& C,}
\DoxyCodeLine{188     \textcolor{keyword}{const} TA\&      \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{189     \textcolor{keyword}{const} TB\&      \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{190     \textcolor{keyword}{const} eT       alpha = eT(1),}
\DoxyCodeLine{191     \textcolor{keyword}{const} eT       beta  = eT(0),}
\DoxyCodeLine{192     \textcolor{keyword}{const} \textcolor{keyword}{typename} arma\_not\_cx<eT>::result* junk = \textcolor{keyword}{nullptr}}
\DoxyCodeLine{193     )}
\DoxyCodeLine{194     \{}
\DoxyCodeLine{195     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{196     arma\_ignore(junk);}
\DoxyCodeLine{197     }
\DoxyCodeLine{198     \mbox{\hyperlink{classgemm__emul__large}{gemm\_emul\_large<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply}}(C, \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}, alpha, beta);}
\DoxyCodeLine{199     \}}
\DoxyCodeLine{200   }
\DoxyCodeLine{201   }
\DoxyCodeLine{202   }
\DoxyCodeLine{203   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT>}
\DoxyCodeLine{204   arma\_hot}
\DoxyCodeLine{205   \textcolor{keyword}{inline}}
\DoxyCodeLine{206   \textcolor{keyword}{static}}
\DoxyCodeLine{207   \textcolor{keywordtype}{void}}
\DoxyCodeLine{208   apply}
\DoxyCodeLine{209     (}
\DoxyCodeLine{210           \mbox{\hyperlink{classMat}{Mat<eT>}}\& C,}
\DoxyCodeLine{211     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{212     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{213     \textcolor{keyword}{const} eT       alpha = eT(1),}
\DoxyCodeLine{214     \textcolor{keyword}{const} eT       beta  = eT(0),}
\DoxyCodeLine{215     \textcolor{keyword}{const} \textcolor{keyword}{typename} \mbox{\hyperlink{structarma__cx__only}{arma\_cx\_only<eT>::result}}* junk = \textcolor{keyword}{nullptr}}
\DoxyCodeLine{216     )}
\DoxyCodeLine{217     \{}
\DoxyCodeLine{218     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{219     arma\_ignore(junk);}
\DoxyCodeLine{220     }
\DoxyCodeLine{221     \textcolor{comment}{// "{}better than nothing"{} handling of hermitian transposes for complex number matrices}}
\DoxyCodeLine{222     }
\DoxyCodeLine{223     \mbox{\hyperlink{classMat}{Mat<eT>}} tmp\_A;}
\DoxyCodeLine{224     \mbox{\hyperlink{classMat}{Mat<eT>}} tmp\_B;}
\DoxyCodeLine{225     }
\DoxyCodeLine{226     \textcolor{keywordflow}{if}(do\_trans\_A)  \{ op\_htrans::apply\_mat\_noalias(tmp\_A, \mbox{\hyperlink{structA}{A}}); \}}
\DoxyCodeLine{227     \textcolor{keywordflow}{if}(do\_trans\_B)  \{ op\_htrans::apply\_mat\_noalias(tmp\_B, \mbox{\hyperlink{structB}{B}}); \}}
\DoxyCodeLine{228     }
\DoxyCodeLine{229     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& AA = (do\_trans\_A == \textcolor{keyword}{false}) ? \mbox{\hyperlink{structA}{A}} : tmp\_A;}
\DoxyCodeLine{230     \textcolor{keyword}{const} \mbox{\hyperlink{classMat}{Mat<eT>}}\& BB = (do\_trans\_B == \textcolor{keyword}{false}) ? \mbox{\hyperlink{structB}{B}} : tmp\_B;}
\DoxyCodeLine{231     }
\DoxyCodeLine{232     \mbox{\hyperlink{classgemm__emul__large}{gemm\_emul\_large<false, false, use\_alpha, use\_beta>::apply}}(C, AA, BB, alpha, beta);}
\DoxyCodeLine{233     \}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235   \};}
\DoxyCodeLine{236 }
\DoxyCodeLine{237 }
\DoxyCodeLine{238 }
\DoxyCodeLine{242 }
\DoxyCodeLine{243 \textcolor{keyword}{template}<const \textcolor{keywordtype}{bool} do\_trans\_A=false, const \textcolor{keywordtype}{bool} do\_trans\_B=false, const \textcolor{keywordtype}{bool} use\_alpha=false, const \textcolor{keywordtype}{bool} use\_beta=false>}
\DoxyCodeLine{244 \textcolor{keyword}{class }\mbox{\hyperlink{classgemm}{gemm}}}
\DoxyCodeLine{245   \{}
\DoxyCodeLine{246   \textcolor{keyword}{public}:}
\DoxyCodeLine{247   }
\DoxyCodeLine{248   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{249   \textcolor{keyword}{inline}}
\DoxyCodeLine{250   \textcolor{keyword}{static}}
\DoxyCodeLine{251   \textcolor{keywordtype}{void}}
\DoxyCodeLine{252   apply\_blas\_type( \mbox{\hyperlink{classMat}{Mat<eT>}}\& C, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} TB\& \mbox{\hyperlink{structB}{B}}, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{253     \{}
\DoxyCodeLine{254     arma\_extra\_debug\_sigprint();}
\DoxyCodeLine{255     }
\DoxyCodeLine{256     \textcolor{keywordflow}{if}( (\mbox{\hyperlink{structA}{A}}.n\_rows <= 4) \&\& (\mbox{\hyperlink{structA}{A}}.n\_rows == \mbox{\hyperlink{structA}{A}}.n\_cols) \&\& (\mbox{\hyperlink{structA}{A}}.n\_rows == \mbox{\hyperlink{structB}{B}}.n\_rows) \&\& (\mbox{\hyperlink{structB}{B}}.n\_rows == \mbox{\hyperlink{structB}{B}}.n\_cols) \&\& (\mbox{\hyperlink{structis__cx}{is\_cx<eT>::no}}) ) }
\DoxyCodeLine{257       \{}
\DoxyCodeLine{258       \textcolor{keywordflow}{if}(do\_trans\_B == \textcolor{keyword}{false})}
\DoxyCodeLine{259         \{}
\DoxyCodeLine{260         \mbox{\hyperlink{classgemm__emul__tinysq}{gemm\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}(C, \mbox{\hyperlink{structA}{A}}, \mbox{\hyperlink{structB}{B}}, alpha, beta);}
\DoxyCodeLine{261         \}}
\DoxyCodeLine{262       \textcolor{keywordflow}{else}}
\DoxyCodeLine{263         \{}
\DoxyCodeLine{264         \mbox{\hyperlink{classMat}{Mat<eT>}} BB(\mbox{\hyperlink{structB}{B}}.n\_rows, \mbox{\hyperlink{structB}{B}}.n\_rows, \mbox{\hyperlink{structarma__nozeros__indicator}{arma\_nozeros\_indicator}}());}
\DoxyCodeLine{265         }
\DoxyCodeLine{266         \mbox{\hyperlink{group__op__strans_gac7cc2cfa347e5d0f44d5a022148648d6}{op\_strans::apply\_mat\_noalias\_tinysq}}(BB, \mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{267         }
\DoxyCodeLine{268         \mbox{\hyperlink{classgemm__emul__tinysq}{gemm\_emul\_tinysq<do\_trans\_A, use\_alpha, use\_beta>::apply}}(C, \mbox{\hyperlink{structA}{A}}, BB, alpha, beta);}
\DoxyCodeLine{269         \}}
\DoxyCodeLine{270       \}}
\DoxyCodeLine{271     \textcolor{keywordflow}{else}}
\DoxyCodeLine{272       \{}
\DoxyCodeLine{273 \textcolor{preprocessor}{      \#if defined(ARMA\_USE\_ATLAS)}}
\DoxyCodeLine{274         \{}
\DoxyCodeLine{275         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}atlas::cblas\_gemm()"{}});}
\DoxyCodeLine{276         }
\DoxyCodeLine{277         arma\_debug\_assert\_atlas\_size(\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{278         }
\DoxyCodeLine{279         atlas::cblas\_gemm<eT>}
\DoxyCodeLine{280           (}
\DoxyCodeLine{281           atlas::CblasColMajor,}
\DoxyCodeLine{282           (do\_trans\_A) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? CblasConjTrans : atlas::CblasTrans ) : atlas::CblasNoTrans,}
\DoxyCodeLine{283           (do\_trans\_B) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? CblasConjTrans : atlas::CblasTrans ) : atlas::CblasNoTrans,}
\DoxyCodeLine{284           C.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}},}
\DoxyCodeLine{285           C.\mbox{\hyperlink{classMat_ae4f28b81d1d7ace8ae86d0787f2fd367}{n\_cols}},}
\DoxyCodeLine{286           (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_rows : \mbox{\hyperlink{structA}{A}}.n\_cols,}
\DoxyCodeLine{287           (use\_alpha) ? alpha : eT(1),}
\DoxyCodeLine{288           \mbox{\hyperlink{structA}{A}}.mem,}
\DoxyCodeLine{289           (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_rows : C.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}},}
\DoxyCodeLine{290           \mbox{\hyperlink{structB}{B}}.mem,}
\DoxyCodeLine{291           (do\_trans\_B) ? C.\mbox{\hyperlink{classMat_ae4f28b81d1d7ace8ae86d0787f2fd367}{n\_cols}} : ( (do\_trans\_A) ? \mbox{\hyperlink{structA}{A}}.n\_rows : \mbox{\hyperlink{structA}{A}}.n\_cols ),}
\DoxyCodeLine{292           (use\_beta) ? beta : eT(0),}
\DoxyCodeLine{293           C.\mbox{\hyperlink{group__Mat_gad5b1b46a9288e04128aa11c99cc2b444}{memptr}}(),}
\DoxyCodeLine{294           C.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}}}
\DoxyCodeLine{295           );}
\DoxyCodeLine{296         \}}
\DoxyCodeLine{297 \textcolor{preprocessor}{      \#elif defined(ARMA\_USE\_BLAS)}}
\DoxyCodeLine{298         \{}
\DoxyCodeLine{299         arma\_extra\_debug\_print(\textcolor{stringliteral}{"{}blas::gemm()"{}});}
\DoxyCodeLine{300         }
\DoxyCodeLine{301         arma\_debug\_assert\_blas\_size(\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}});}
\DoxyCodeLine{302         }
\DoxyCodeLine{303         \textcolor{keyword}{const} \textcolor{keywordtype}{char} trans\_A = (do\_trans\_A) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? \textcolor{charliteral}{'C'} : \textcolor{charliteral}{'T'} ) : \textcolor{charliteral}{'N'};}
\DoxyCodeLine{304         \textcolor{keyword}{const} \textcolor{keywordtype}{char} trans\_B = (do\_trans\_B) ? ( \mbox{\hyperlink{structis__cx}{is\_cx<eT>::yes}} ? \textcolor{charliteral}{'C'} : \textcolor{charliteral}{'T'} ) : \textcolor{charliteral}{'N'};}
\DoxyCodeLine{305         }
\DoxyCodeLine{306         \textcolor{keyword}{const} blas\_int m   = blas\_int(C.\mbox{\hyperlink{classMat_a751755caeae1d831a1c27049740e7360}{n\_rows}});}
\DoxyCodeLine{307         \textcolor{keyword}{const} blas\_int n   = blas\_int(C.\mbox{\hyperlink{classMat_ae4f28b81d1d7ace8ae86d0787f2fd367}{n\_cols}});}
\DoxyCodeLine{308         \textcolor{keyword}{const} blas\_int k   = (do\_trans\_A) ? blas\_int(\mbox{\hyperlink{structA}{A}}.n\_rows) : blas\_int(\mbox{\hyperlink{structA}{A}}.n\_cols);}
\DoxyCodeLine{309         }
\DoxyCodeLine{310         \textcolor{keyword}{const} eT local\_alpha = (use\_alpha) ? alpha : eT(1);}
\DoxyCodeLine{311         }
\DoxyCodeLine{312         \textcolor{keyword}{const} blas\_int lda = (do\_trans\_A) ? k : m;}
\DoxyCodeLine{313         \textcolor{keyword}{const} blas\_int ldb = (do\_trans\_B) ? n : k;}
\DoxyCodeLine{314         }
\DoxyCodeLine{315         \textcolor{keyword}{const} eT local\_beta  = (use\_beta) ? beta : eT(0);}
\DoxyCodeLine{316         }
\DoxyCodeLine{317         arma\_extra\_debug\_print( \mbox{\hyperlink{classarma__str_1_1format}{arma\_str::format}}(\textcolor{stringliteral}{"{}blas::gemm(): trans\_A = \%c"{}}) \% trans\_A );}
\DoxyCodeLine{318         arma\_extra\_debug\_print( \mbox{\hyperlink{classarma__str_1_1format}{arma\_str::format}}(\textcolor{stringliteral}{"{}blas::gemm(): trans\_B = \%c"{}}) \% trans\_B );}
\DoxyCodeLine{319         }
\DoxyCodeLine{320         blas::gemm<eT>}
\DoxyCodeLine{321           (}
\DoxyCodeLine{322           \&trans\_A,}
\DoxyCodeLine{323           \&trans\_B,}
\DoxyCodeLine{324           \&m,}
\DoxyCodeLine{325           \&n,}
\DoxyCodeLine{326           \&k,}
\DoxyCodeLine{327           \&local\_alpha,}
\DoxyCodeLine{328           \mbox{\hyperlink{structA}{A}}.mem,}
\DoxyCodeLine{329           \&lda,}
\DoxyCodeLine{330           \mbox{\hyperlink{structB}{B}}.mem,}
\DoxyCodeLine{331           \&ldb,}
\DoxyCodeLine{332           \&local\_beta,}
\DoxyCodeLine{333           C.\mbox{\hyperlink{group__Mat_gad5b1b46a9288e04128aa11c99cc2b444}{memptr}}(),}
\DoxyCodeLine{334           \&m}
\DoxyCodeLine{335           );}
\DoxyCodeLine{336         \}}
\DoxyCodeLine{337 \textcolor{preprocessor}{      \#else}}
\DoxyCodeLine{338         \{}
\DoxyCodeLine{339         \mbox{\hyperlink{classgemm__emul}{gemm\_emul<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{340         \}}
\DoxyCodeLine{341 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{342       \}}
\DoxyCodeLine{343     \}}
\DoxyCodeLine{344   }
\DoxyCodeLine{345   }
\DoxyCodeLine{346   }
\DoxyCodeLine{348   \textcolor{keyword}{template}<\textcolor{keyword}{typename} eT, \textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{349   \textcolor{keyword}{inline}}
\DoxyCodeLine{350   \textcolor{keyword}{static}}
\DoxyCodeLine{351   \textcolor{keywordtype}{void}}
\DoxyCodeLine{352   \mbox{\hyperlink{classgemm_a3b724124ae4233a25bcc4619742a44e8}{apply}}( \mbox{\hyperlink{classMat}{Mat<eT>}}\& C, \textcolor{keyword}{const} TA\& \mbox{\hyperlink{structA}{A}}, \textcolor{keyword}{const} TB\& \mbox{\hyperlink{structB}{B}}, \textcolor{keyword}{const} eT alpha = eT(1), \textcolor{keyword}{const} eT beta = eT(0) )}
\DoxyCodeLine{353     \{}
\DoxyCodeLine{354     \mbox{\hyperlink{classgemm__emul}{gemm\_emul<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{355     \}}
\DoxyCodeLine{356   }
\DoxyCodeLine{357   }
\DoxyCodeLine{358   }
\DoxyCodeLine{359   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{360   arma\_inline}
\DoxyCodeLine{361   \textcolor{keyword}{static}}
\DoxyCodeLine{362   \textcolor{keywordtype}{void}}
\DoxyCodeLine{363   \mbox{\hyperlink{classgemm_a3b724124ae4233a25bcc4619742a44e8}{apply}}}
\DoxyCodeLine{364     (}
\DoxyCodeLine{365           \mbox{\hyperlink{classMat}{Mat<float>}}\& C,}
\DoxyCodeLine{366     \textcolor{keyword}{const} TA\&         \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{367     \textcolor{keyword}{const} TB\&         \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{368     \textcolor{keyword}{const} \textcolor{keywordtype}{float} alpha = \textcolor{keywordtype}{float}(1),}
\DoxyCodeLine{369     \textcolor{keyword}{const} \textcolor{keywordtype}{float} beta  = \textcolor{keywordtype}{float}(0)}
\DoxyCodeLine{370     )}
\DoxyCodeLine{371     \{}
\DoxyCodeLine{372     \mbox{\hyperlink{classgemm}{gemm<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply\_blas\_type}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{373     \}}
\DoxyCodeLine{374   }
\DoxyCodeLine{375   }
\DoxyCodeLine{376   }
\DoxyCodeLine{377   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{378   arma\_inline}
\DoxyCodeLine{379   \textcolor{keyword}{static}}
\DoxyCodeLine{380   \textcolor{keywordtype}{void}}
\DoxyCodeLine{381   \mbox{\hyperlink{classgemm_a3b724124ae4233a25bcc4619742a44e8}{apply}}}
\DoxyCodeLine{382     (}
\DoxyCodeLine{383           \mbox{\hyperlink{classMat}{Mat<double>}}\& C,}
\DoxyCodeLine{384     \textcolor{keyword}{const} TA\&          \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{385     \textcolor{keyword}{const} TB\&          \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{386     \textcolor{keyword}{const} \textcolor{keywordtype}{double} alpha = \textcolor{keywordtype}{double}(1),}
\DoxyCodeLine{387     \textcolor{keyword}{const} \textcolor{keywordtype}{double} beta  = \textcolor{keywordtype}{double}(0)}
\DoxyCodeLine{388     )}
\DoxyCodeLine{389     \{}
\DoxyCodeLine{390     \mbox{\hyperlink{classgemm}{gemm<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply\_blas\_type}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{391     \}}
\DoxyCodeLine{392   }
\DoxyCodeLine{393   }
\DoxyCodeLine{394   }
\DoxyCodeLine{395   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{396   arma\_inline}
\DoxyCodeLine{397   \textcolor{keyword}{static}}
\DoxyCodeLine{398   \textcolor{keywordtype}{void}}
\DoxyCodeLine{399   \mbox{\hyperlink{classgemm_a3b724124ae4233a25bcc4619742a44e8}{apply}}}
\DoxyCodeLine{400     (}
\DoxyCodeLine{401           \mbox{\hyperlink{classMat}{Mat}}< std::complex<float> >\& C,}
\DoxyCodeLine{402     \textcolor{keyword}{const} TA\&                         \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{403     \textcolor{keyword}{const} TB\&                         \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{404     \textcolor{keyword}{const} std::complex<float> alpha = std::complex<float>(1),}
\DoxyCodeLine{405     \textcolor{keyword}{const} std::complex<float> beta  = std::complex<float>(0)}
\DoxyCodeLine{406     )}
\DoxyCodeLine{407     \{}
\DoxyCodeLine{408     \mbox{\hyperlink{classgemm}{gemm<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply\_blas\_type}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{409     \}}
\DoxyCodeLine{410   }
\DoxyCodeLine{411   }
\DoxyCodeLine{412   }
\DoxyCodeLine{413   \textcolor{keyword}{template}<\textcolor{keyword}{typename} TA, \textcolor{keyword}{typename} TB>}
\DoxyCodeLine{414   arma\_inline}
\DoxyCodeLine{415   \textcolor{keyword}{static}}
\DoxyCodeLine{416   \textcolor{keywordtype}{void}}
\DoxyCodeLine{417   \mbox{\hyperlink{classgemm_a3b724124ae4233a25bcc4619742a44e8}{apply}}}
\DoxyCodeLine{418     (}
\DoxyCodeLine{419           \mbox{\hyperlink{classMat}{Mat}}< std::complex<double> >\& C,}
\DoxyCodeLine{420     \textcolor{keyword}{const} TA\&                          \mbox{\hyperlink{structA}{A}},}
\DoxyCodeLine{421     \textcolor{keyword}{const} TB\&                          \mbox{\hyperlink{structB}{B}},}
\DoxyCodeLine{422     \textcolor{keyword}{const} std::complex<double> alpha = std::complex<double>(1),}
\DoxyCodeLine{423     \textcolor{keyword}{const} std::complex<double> beta  = std::complex<double>(0)}
\DoxyCodeLine{424     )}
\DoxyCodeLine{425     \{}
\DoxyCodeLine{426     \mbox{\hyperlink{classgemm}{gemm<do\_trans\_A, do\_trans\_B, use\_alpha, use\_beta>::apply\_blas\_type}}(C,\mbox{\hyperlink{structA}{A}},\mbox{\hyperlink{structB}{B}},alpha,beta);}
\DoxyCodeLine{427     \}}
\DoxyCodeLine{428   }
\DoxyCodeLine{429   \};}
\DoxyCodeLine{430 }
\DoxyCodeLine{431 }
\DoxyCodeLine{432 }

\end{DoxyCode}
